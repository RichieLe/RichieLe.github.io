

<!DOCTYPE html>
<html lang="zh-CN" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Spring笔记 - Pearbook</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  <meta name="description" content="1  Spring1.1 简介
Spring：春天——...">
  <meta name="author" content="Richie">
  <link rel="icon" href="/images/icons/16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/128x128.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/128x128.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="https://at.alicdn.com/t/font_1445822_p6ry5n7lrr.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      loading: {
        gif: '/images/theme/loading.gif',
        lottie: ''
      },
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: {
          gif: '/images/theme/loading.gif',
          lottie: ''
        }
      },
      donate: {
        enable: false,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: '黎书·No One But You',
          typing: false,
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: false,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'default'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: false,
        path: ''
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 5.4.1"></head>

<body class="lock-screen">
  <div class="loading" id="loading"></div>
  
    


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconhome j-navbar-back-home"></i>
      
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
      
    </div>
    <div class="center">Spring笔记</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
  </nav>

  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> 首页</a>
      </li><li class="menu-item">
        <a href="/galleries/ " class="underline "> 相册</a>
      </li><li class="menu-item">
        <a href="/archives/ " class="underline "> 归档</a>
      </li><li class="menu-item">
        <a href="/tags/ " class="underline "> 标签</a>
      </li><li class="menu-item">
        <a href="/categories/ " class="underline "> 分类</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> 关于</a>
      </li></ul>
    
      <div class="menu-copyright"><p>黎书·No One But You</p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">Spring笔记</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>三月 10, 2022</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>87565</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        
        <h2 id="1-Spring"><a href="#1-Spring" class="headerlink" title="1  Spring"></a>1  Spring</h2><h3 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h3><ul>
<li>Spring：春天——&gt; 给软件行业带来了春天</li>
<li>2002，首次推出spring框架的雏形：interface21框架！</li>
<li>Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，于2004年3月24日，发布了1.0正式版。</li>
<li>Spring理念 : 使现有技术更加使用. 本身就是一个大杂烩 , 整合现有的框架技术。</li>
<li>Spring是一个开源的轻量级的==一站式==容器框架<ul>
<li>spring在javaweb三层结构中，每一层都提供了解决技术<ol>
<li><strong>web层：springmvc</strong></li>
<li><strong>业务层：ioc和声明式事务aop</strong></li>
<li><strong>持久层：jdbctemplate</strong></li>
</ol>
</li>
</ul>
</li>
<li><strong>Spring是一个轻量级的控制反转(IoC)和面向切面(AOP)的容器（框架）</strong></li>
</ul>
<h3 id="1-2-优缺与核心"><a href="#1-2-优缺与核心" class="headerlink" title="1.2 优缺与核心"></a>1.2 优缺与核心</h3><ol>
<li><p><strong>优点</strong></p>
<ul>
<li>Spring是一个开源免费的框架 , 容器  .</li>
<li>Spring是一个轻量级的框架 , 非侵入式的 .</li>
<li>支持面向==接口==编程</li>
<li>管理整个项目，兼容其他优秀框架</li>
<li>提供众多服务，例如：事务管理</li>
<li>优秀的web框架的springmvc替代struts2</li>
</ul>
</li>
<li><p><strong>缺点</strong></p>
<ul>
<li>控制器过于灵活，缺少一个公用的控制器，jsp代码量过大</li>
<li>不支持分布式，造成 ejb 目前还在使用</li>
</ul>
</li>
<li><p><strong>Spring核心只有两部分</strong></p>
<ol>
<li><strong>ioc：控制反转</strong></li>
<li><strong>aop：面向切面编程</strong></li>
</ol>
</li>
</ol>
<h3 id="1-3-组成"><a href="#1-3-组成" class="headerlink" title="1.3 组成"></a>1.3 组成</h3><p>   <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/arch1.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">img</span></p>
<table>
<thead>
<tr>
<th>核心容器层</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Core 模块</td>
<td>提供了框架的基本组成部分，包括 IoC 及依赖注入功能。</td>
</tr>
<tr>
<td>Bean 模块</td>
<td>实现 Bean 管理，包括自动装配机制等功能； 其中BeanFactory是一个工厂模式的实现。</td>
</tr>
<tr>
<td>Context 模块</td>
<td>建立在 Core 和 Bean 模块基础上，通常用于访问配置及定义的任何对象。<br>ApplicationContext 是上下文模块的重要接口。</td>
</tr>
<tr>
<td>SpEL 模块</td>
<td>表达式语言模块提供了运行时进行查询及操作一个对象的表达式机制。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>数据访问/集成</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>JDBC 模块</td>
<td>用于替代繁琐的 JDBC API 的抽象层。</td>
</tr>
<tr>
<td>ORM 模块</td>
<td>对象关系数据库映射抽象层，可集成JPA，JDO，Hibernate，iBatis。</td>
</tr>
<tr>
<td>OXM 模块</td>
<td>XML消息绑定抽象层，支持JAXB，Castor，XMLBeans，JiBX，XStream。</td>
</tr>
<tr>
<td>JMS 模块</td>
<td>Java消息服务模块，实现消息生产-消费之类的功能。</td>
</tr>
<tr>
<td>Transaction 模块</td>
<td>事务模块为各种 POJO 支持编程式和声明式事务管理。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Web应用</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Web 模块</td>
<td>Web MVC 提供了基于 <strong>模型-视图-控制器</strong> 的基础web应用框架。</td>
</tr>
<tr>
<td>servlet 模块</td>
<td>实现了统一的监听器以及和面向web应用的上下文，用以初始化 IoC 容器。</td>
</tr>
<tr>
<td>Web-Portlet</td>
<td>实现在 portlet 环境中实现 MVC。</td>
</tr>
<tr>
<td>Web-Socket 模块</td>
<td>为 WebSocket连接 提供支持。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>其他模块</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>AOP 模块</td>
<td>提供了面向切面的编程实现<br>允许开发者通过定义方法拦截器及切入点对代码进行无耦合集成<br>它实现了关注点分离。</td>
</tr>
<tr>
<td>Aspects 模块</td>
<td>提供了与 AspectJ 的集成<br>这是一个功能强大且成熟的面向切面编程（AOP）框架。</td>
</tr>
<tr>
<td>Instrumentation 模块</td>
<td>实现instrumentation支持，一般用以应用服务器的监测。</td>
</tr>
<tr>
<td>Messaging 模块</td>
<td>为STOMP 提供了支持，STOMP协议是一种简单的文本定向消息协议，<br>是 WebSocket 的子协议。</td>
</tr>
<tr>
<td>测试</td>
<td>支持 JUnit 、TestNG 框架的集成</td>
</tr>
</tbody></table>
<ul>
<li><strong>Spring 框架是一个分层架构，由 7 个定义良好的模块组成。Spring 模块构建在核心容器之上，核心容器定义了创建、配置和管理 bean 的方式 .</strong></li>
</ul>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1569934897811.png</span></p>
<p>组成 Spring 框架的每个模块（或组件）都可以<strong>单独存在</strong>，或者与其他一个或多个模块联合实现。每个模块的功能如下：</p>
<ul>
<li><strong>核心容器（Spring Core）</strong>：核心容器提供 Spring 框架的基本功能。核心容器的主要组件是 <code>BeanFactory</code>，它是工厂模式的实现。<code>BeanFactory</code> 使用<strong>控制反转</strong>（IOC） 模式将应用程序的配置和依赖性规范与实际的应用程序代码分开。</li>
<li><strong>Spring 上下文（Spring Context）</strong>：Spring 上下文是一个配置文件，向 Spring 框架提供上下文信息。Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</li>
<li><strong>Spring面向切面编程（Spring AOP）</strong>：通过配置管理特性，Spring AOP 模块直接将<strong>面向切面</strong>的编程功能 ,  集成到了 Spring 框架中。所以，可以很容易地使 Spring 框架管理任何支持 AOP的对象。Spring AOP 模块为基于  Spring 的应用程序中的对象提供了事务管理服务。通过使用 Spring AOP，不用依赖组件，就可以将声明性事务管理集成到应用程序中。</li>
<li><strong>Spring DAO模块</strong>：JDBC，DAO  抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。Spring  DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</li>
<li><strong>Spring ORM模块</strong>：Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具，其中包括 JDO、Hibernate 和 iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</li>
<li><strong>Spring Web 模块</strong>：Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。所以，Spring 框架支持与 Jakarta Struts 的集成。Web 模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</li>
<li><strong>Spring MVC 框架</strong>：MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</li>
</ul>
<h3 id="1-4-拓展"><a href="#1-4-拓展" class="headerlink" title="1.4 拓展"></a>1.4 拓展</h3><p>在Spring的官网有这个介绍：现代化的Java开发！说白了就是基于Spring的开发！</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579438674440.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579438674440</span></p>
<ul>
<li>Spring Boot<ul>
<li>一个快速开发的脚手架。</li>
<li>基于SpringBoot可以快速的开发单个微服务<ul>
<li>连接数据库是一个模块，对数据库的操作,专门提出来，提出一个项目——它<strong>就是一个微服务</strong></li>
</ul>
</li>
<li>约定大于配置！</li>
</ul>
</li>
<li>Spring Cloud<ul>
<li>Spring Cloud是基于SpringBoot实现的</li>
</ul>
</li>
</ul>
<p><font style="color:#ff0000">因为现在大多数公司都在使用SpringBoot进行快速开发，<strong>学习SpringBoot的前提，需要完全掌握Spring及SpringMVC！ 承上启下的作用！</strong></font></p>
<p><strong>弊端：发展了太久之后，违背了原来的理念！配置十分繁琐，人称：“配置地狱”！</strong></p>
<h3 id="1-5-jar包"><a href="#1-5-jar包" class="headerlink" title="1.5 jar包"></a>1.5 jar包</h3><figure class="highlight plaintext"><figcaption><span>et</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.2.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.2.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>



<h2 id="2-IOC"><a href="#2-IOC" class="headerlink" title="2  IOC"></a>2  <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f03074c17081">IOC</a></h2><h3 id="2-0-IOC的概念"><a href="#2-0-IOC的概念" class="headerlink" title="2.0 IOC的概念"></a>2.0 <a target="_blank" rel="noopener" href="https://blog.csdn.net/GoGleTech/article/details/79557416">IOC的概念</a></h3><ol>
<li><p><strong>==IOC（ Inversion of Control ）==</strong> </p>
<ul>
<li><p> ==Ioc目的==——<a target="_blank" rel="noopener" href="http://baijiahao.baidu.com/s?id=1649715632677347435&wfr=spider&for=pc">==解耦==</a></p>
</li>
<li><p>==控制反转==：把创建对象及对象之间关系的维护的权限转交给spring 容器管理，不是什么技术，而是一种设计思想，是面向对象编程法则</p>
</li>
<li><p> IoC很好的体现了面向对象设计法则之一—— 好莱坞法则：“==别找我们，我们找你==”；即由IoC容器帮对象找相应的依赖对象并注入，而不是由对象主动去找。 </p>
</li>
</ul>
</li>
<li><p><strong>==DI（Dependency Injection）==</strong> </p>
<ul>
<li>==依赖注入==：把一个对象依赖另一个对象注入到容器中，是对象依赖关系由容器在运行期决定</li>
<li>（2004年大师级人物Martin Fowler 又给出了一个新的名字：“依赖注入”，相对IOC而言，“依赖注入”明确描述了“被注入对象依赖IOC容器配置依赖对象”）</li>
</ul>
</li>
<li><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583719927350.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 67%;"><span class="image-caption">1583719927350</span></li>
</ol>
<h4 id="IOC-和-DI-的区别"><a href="#IOC-和-DI-的区别" class="headerlink" title="IOC 和 DI 的区别"></a>IOC 和 DI 的区别</h4><ol>
<li><strong>==IOC==</strong><ol>
<li>==传统方式==在程序中创建对象并且在对象内部创建依赖对象，是程序主动创建了依赖关系，这种依赖方式被称为==主动依赖==  </li>
<li>==IOC== 方式把创建对象及对象之间关系的维护的权限转交给spring 容器管理，它提供一个第三方的工厂，这个工厂你要什么，它就给你提供什么，IOC 方式创建对象不需要 new<ul>
<li>==谁控制谁==：IOC 容器控制了对象</li>
<li>==控制了什么==：控制了对象的创建，关系，生命周期及文件</li>
<li>==哪些方面反转了==：依赖的对象被反转了</li>
<li>==为何是反转==：有了反转就有正转，==正传==是程序主动创建依赖关系及对象，而==反转==是容器帮我创建了依赖对象及依赖关系，对象被动被注入了依赖对象</li>
</ul>
</li>
</ol>
</li>
<li><strong>==DI（Dependency Injection）==</strong> <ul>
<li>==谁依赖于谁==：程序依赖了IOC 容器</li>
<li>==为什么需要依赖==：程序需要IOC 容器提供的对象及资源</li>
<li>==谁注入谁==：容器注入了对象及依赖对象还要它们的关系</li>
<li>==注入了什么==：对象的依赖对象，资源，常量等</li>
</ul>
</li>
<li>IOC 和 DI 的关系<ul>
<li>DI 是建立在IOC 基础之上，DI 强调是==关系==，DI 不能单独存在</li>
</ul>
</li>
</ol>
<h3 id="2-1-IOC的推理"><a href="#2-1-IOC的推理" class="headerlink" title="2.1 IOC的推理"></a>2.1 IOC的推理</h3><p>1.UserDao接口</p>
<p>2.UserDaoImpl实现类</p>
<p>3.UserService业务接口</p>
<p>4.UserServiceImpl业务实现类</p>
<p>在之前的业务中，用户的需求(<strong>DaoImpl</strong>)可能会影响我们原来的代码(<strong>ServiceImpl</strong>)，我们需要根据用户的需求的修改原来的代码，如果程序代码量大，修改一次的成本十分昂贵</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579452125807.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579452125807</span></p>
<p>我们使用一个Set接口实现（已经发生革命性的变化）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//service类：业务逻辑</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"><span class="comment">//利用set进行动态实现值的注入！</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">	<span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试类：用户</span></span><br><span class="line"><span class="comment">//用户实际调用的是业务层，dao层不需要接触！</span></span><br><span class="line">UserService userService=<span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">((UserServiceImpl) userService).setUserDao(<span class="keyword">new</span> <span class="title class_">OracleDaoImpl</span>());</span><br><span class="line">userService.getUser();</span><br></pre></td></tr></table></figure>

<p>之前程序<strong>主动</strong>创建对象！ 控制器在程序猿手上：<font style="color:#ff0000">这就是控制反转</font></p>
<p>使用set注入后，程序不再具有主动性，而是变成了<strong>被动</strong>的接收对象<br> <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/20200108233449567.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">ssm</span></p>
<p><font style="color:#ff0000">这种思想，从本质上解决了问题，我们程序猿不用再去管理对象的创建，系统耦合性降低 ，可以更加专注在业务的实现上 ，这就是<strong>IOC的原型</strong>！</font></p>
<h3 id="2-2-IOC的本质"><a href="#2-2-IOC的本质" class="headerlink" title="2.2 IOC的本质"></a>2.2 IOC的本质</h3><ul>
<li><p><strong>控制反转IOC(Inversion of Control)，是一种设计思想，DI(依赖注入)是实现IOC的一种方法</strong>，也有人认为DI只是IOC的另一种说法。</p>
</li>
<li><p><em><strong>没有IOC的程序中 , 我们使用面向对象编程</strong></em> , 对象的创建与对象间的依赖关系==完全硬编码==在程序中，</p>
<ul>
<li>对象的创建由程序 ==自己== 控制，控制反转后将对象的创建转移给==第三方== </li>
</ul>
</li>
<li><p><strong>个人认为所谓控制反转就是：==获得依赖对象的方式反转了。==</strong></p>
</li>
</ul>
<p> <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/20200108233507544.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">ssm</span></p>
<ul>
<li><p>Spring容器在初始化时先==读取==配置文件，根据配置文件或元数据创建与组织对象==存入==容器中，程序==使用==时再从Ioc容器中==取出==需要的对象。</p>
<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/2.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 67%;"><span class="image-caption">ssm</span></li>
<li><p><strong>IOC是Spring框架的核心内容</strong>，使用多种方式完美的==实现==了IoC，可以使用<strong>XML配置</strong>，也可以使用<strong>注解</strong>，新版本的Spring也可以<strong>零配置</strong>实现IoC。</p>
<ul>
<li>采用**==XML==**方式配置Bean的时候，Bean的定义信息是和实现==分离==的，</li>
<li>而采用**==注解==<strong>的方式可以把两者==合为==一体，Bean的定义信息直接以注解的形式定义在实现类中，从而达到了</strong>零配置**的目的。</li>
<li>控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式。在Spring中实现控制反转的是IoC容器，其实现方法是**==依赖注入==**（Dependency Injection,DI）。</li>
</ul>
</li>
</ul>
<h4 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h4><ul>
<li>Hello 对象是谁创建的 ?  【 hello 对象是由Spring创建的 】</li>
<li>Hello 对象的属性是怎么设置的 ?  【hello 对象的属性是由Spring容器设置的 】</li>
</ul>
<p>这个过程就叫控制反转 :</p>
<ul>
<li><p><strong>控制 : 谁来控制对象的创建 , 传统应用程序的对象是由程序本身控制创建的 , 使用Spring后 , 对象是由Spring来创建的</strong></p>
</li>
<li><p><strong>反转 : 程序本身不创建对象 , 而变成被动的接收对象 .</strong></p>
</li>
<li><p>依赖注入 : 就是利用set方法来进行注入的.</p>
</li>
<li><p><strong>IOC是一种编程思想，由主动的编程变成被动的接收</strong></p>
</li>
<li><p>我们彻底不用在程序中去改动了，要实现不同的操作，只需要在xml配置文件中进行修改。</p>
</li>
<li><p><strong>所谓的IOC：对象由Spring来创建，管理，装配！</strong></p>
</li>
</ul>
<h3 id="2-3-IOC的原理"><a href="#2-3-IOC的原理" class="headerlink" title="2.3 IOC的原理"></a>2.3 IOC的原理</h3><ol>
<li><p>==xml 文件==</p>
</li>
<li><p>==流（WritableResource）==</p>
</li>
<li><p>==解析xml 文件（BeanDefinitionParserDelegate）==</p>
</li>
<li><p>==工厂设计模式（AbstractBeanFactory）==</p>
</li>
<li><p>==反射（InstantiationStrategy）==</p>
</li>
<li><p><strong>分析 IOC 原理</strong> </p>
<ul>
<li>==传统方式==</li>
</ul>
<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583724865815.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 80%;"><span class="image-caption">1583724865815</span>

<ul>
<li>==IOC 方式==</li>
</ul>
<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583724751240.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 50%;"><span class="image-caption">1583724751240</span></li>
</ol>
<ul>
<li>==<strong>Spring容器的原理</strong>==，其实就是通过==解析==xml文件，或==取到==用户配置的bean，然后通过==反射==将这些bean挨个放到集合中，然后对外==提供==一个getBean()方法，以便我们==获得==这些bean。下面是一段简单的模拟代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassPathXmlApplicationContext</span> <span class="keyword">implements</span> <span class="title class_">BeanFactory</span>  &#123;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">//容器的核心，用来存放注入的Bean  </span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; container = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Object&gt;();  </span><br><span class="line"></span><br><span class="line">    <span class="comment">//解析xml文件，通过反射将配置的bean放到container中  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ClassPathXmlApplicationContext</span><span class="params">(String fileName)</span> <span class="keyword">throws</span> Exception&#123;  </span><br><span class="line">        <span class="type">SAXBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();  </span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> sb.build(<span class="built_in">this</span>.getClass().</span><br><span class="line">                                getClassLoader().getResourceAsStream(fileName));  </span><br><span class="line">        <span class="type">Element</span> <span class="variable">root</span> <span class="operator">=</span> doc.getRootElement();  </span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> XPath.selectNodes(root, <span class="string">&quot;/beans/bean&quot;</span>);  </span><br><span class="line"></span><br><span class="line">        <span class="comment">//扫描配置文件中的bean  </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++) &#123;              </span><br><span class="line">           <span class="type">Element</span> <span class="variable">bean</span> <span class="operator">=</span> (Element) list.get(i);  </span><br><span class="line">           <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> bean.getAttributeValue(<span class="string">&quot;id&quot;</span>);  </span><br><span class="line">           <span class="type">String</span> <span class="variable">clazz</span> <span class="operator">=</span> bean.getAttributeValue(<span class="string">&quot;class&quot;</span>);  </span><br><span class="line">           <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> Class.forName(clazz).newInstance();  </span><br><span class="line">           container.put(id, o);  </span><br><span class="line">          &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getBean</span><span class="params">(String id)</span> &#123;        </span><br><span class="line">        <span class="keyword">return</span> container.get(id);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<ul>
<li><p>首先==声明==一个存放bean的Map，然后通过jdom==解析==配置文件，循环遍历所有的节点，并通过==反射==将它们放到我们之前声明的Map中。然后提供一个getBean()的方法，让我们可以通过bean的Id来找到我们想要的bean。 </p>
</li>
<li><p>客户端通过调用前面的ClassPathXmlApplicationContext，来加载上面的配置文件，然后就可以通过Id来获得我们需要的bean了</p>
</li>
</ul>
<h3 id="2-4-IOC创建对象的方式"><a href="#2-4-IOC创建对象的方式" class="headerlink" title="2.4  IOC创建对象的方式"></a>2.4  IOC创建对象的方式</h3><p><strong>==bean 的实例化三种方式==</strong></p>
<ol>
<li><p><strong>调用无参数构造器</strong> </p>
<ul>
<li><p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583893566158.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1583893566158</span></p>
</li>
<li><p>没有默认构造器就抛出异常</p>
</li>
<li><p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583892385326.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1583892385326</span></p>
</li>
</ul>
</li>
<li><p><strong>静态工厂</strong> </p>
<ul>
<li><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583892650446.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom:80%;"><span class="image-caption">1583892650446</span></li>
<li><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583892760397.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1583892760397</span></li>
</ul>
</li>
<li><p>**实例工厂 ** </p>
<ul>
<li><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583892982767.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom:80%;"><span class="image-caption">1583892982767</span></li>
<li><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583893072916.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1583893072916</span></li>
</ul>
</li>
</ol>
<hr>
<ol>
<li><p>使用<strong>无参构造</strong>创建对象，默认！ </p>
</li>
<li><p>假设我们要使用<strong>有参构造</strong>创建对象。</p>
<ol>
<li><p>下标赋值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--第一种：下标赋值！--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;妹子&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>类型</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--第二种：通过数据类型创建，不建议使用！--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.pojo.User&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;妹子&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>参数名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--第三种：直接通过参数名来设置！--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;user&quot;</span> class=<span class="string">&quot;com.yan.pojo.User&quot;</span>&gt;</span><br><span class="line"> &lt;constructor-arg name=<span class="string">&quot;name&quot;</span> value=<span class="string">&quot;妹子&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p><strong>总结：在配置文件加载时，容器中管理的对象就已经初始化了！</strong>（applicationContext容器）</p>
<h2 id="3-Spring容器"><a href="#3-Spring容器" class="headerlink" title="3 Spring容器"></a>3 Spring容器</h2><h3 id="3-1-别名"><a href="#3-1-别名" class="headerlink" title="3.1 别名"></a>3.1 别名</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--第一种：alias--&gt;</span><br><span class="line">&lt;alias name=&quot;user&quot; alias=&quot;user2&quot;/&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-Bean的属性"><a href="#3-2-Bean的属性" class="headerlink" title="3.2  Bean的属性"></a>3.2  Bean的属性</h3><ol>
<li><p>id：</p>
<ul>
<li>bean 的唯一标识符，也就是相当于对象名；</li>
<li>必须以字母开头，不能包含一些特殊字符。</li>
<li><strong>Spring根据class属性创建对应类的实例后，会以id为键key，实例对象为值value放入一个Map中，当调用getBean方法时，则会根据id的值从Map中把实例取出来。</strong></li>
</ul>
</li>
<li><p>class：</p>
<ul>
<li>bean 对象所对应的全限定名：包名+类型；</li>
<li>通过反射创建这个类型的对象</li>
<li> <strong>不能是接口</strong> </li>
</ul>
</li>
<li><p>name：</p>
<ul>
<li>也是别名，而且name可以同时取多个别名；</li>
<li> 可以出现特殊符号，当没有设置id的时候，name也可以作为id </li>
<li>和id很像，如果没有空格，逗号，分号是一样的，如果有几个符合，代表一个对象有多个名称，</li>
<li>例如</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean name=&quot;<span class="selector-tag">a</span>;<span class="selector-tag">b</span>&quot; .../&gt; bean 的名称要不 <span class="selector-tag">a</span> 要不  <span class="selector-tag">b</span></span><br><span class="line">&lt;!--==================--&gt;</span><br><span class="line">&lt;bean id=&quot;user&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.User</span>&quot; name=&quot;user2,user3 user4;user5&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;蔑之战&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>scope 四个值： Bean的作用范围 </p>
<ul>
<li><p><strong>singleton</strong>： 默认值，单例的，每次调用getBean方法创建的是同一个对象 </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;user1&quot; class=&quot;com<span class="selector-class">.codeliu</span><span class="selector-class">.entity</span><span class="selector-class">.User</span>&quot; scope=&quot;singleton&quot;&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--进行测试--&gt;</span><br><span class="line">User user = (User)context<span class="selector-class">.getBean</span>(&quot;user1&quot;);</span><br><span class="line">User user2 = (User)context<span class="selector-class">.getBean</span>(&quot;user1&quot;);</span><br><span class="line">// true</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(user == user2);</span><br></pre></td></tr></table></figure>

<ul>
<li> 可以看到，创建一个实例后，这个唯一实例会被缓存起来，下一次要请求使用就直接返回缓存中的实例。 </li>
</ul>
</li>
<li><p><strong>prototype</strong>： 多例的，每次调用getBean方法创建的是不同的对象 </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;user1&quot; class=&quot;com<span class="selector-class">.codeliu</span><span class="selector-class">.entity</span><span class="selector-class">.User</span>&quot; scope=&quot;prototype&quot;&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--进行测试--&gt;</span><br><span class="line">User user = (User)context<span class="selector-class">.getBean</span>(&quot;user1&quot;);</span><br><span class="line">User user2 = (User)context<span class="selector-class">.getBean</span>(&quot;user1&quot;);</span><br><span class="line">// false</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(user == user2);</span><br></pre></td></tr></table></figure>

<ul>
<li> 每次请求都会创建一个新的实例，这样就会出现频繁的创建和销毁对象，造成很大的开销，因此，如果不是必要，不设置成prototype。 </li>
</ul>
</li>
<li><p><strong>request</strong>：web项目中，Spring创建一个Bean的对象，将对象存入request域中</p>
</li>
<li><p><strong>session</strong>：web项目中，Spring创建一个Bean的对象，将对象存入session域中</p>
</li>
<li><p><strong>globalSession</strong>：web项目中，应用在Porlet环境，如果没有Porlet环境，那么globalSession相当于session。</p>
</li>
</ul>
</li>
<li><p>factory-bean：使用某个对象</p>
</li>
<li><p>factory-method：使用某个方法</p>
</li>
</ol>
<h3 id="3-3-spring的获取对象的方式"><a href="#3-3-spring的获取对象的方式" class="headerlink" title="3.3 spring的获取对象的方式"></a>3.3 spring的获取对象的方式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getBean(&quot;id&quot;); //获取对象必须拆箱，性能会低</span><br><span class="line">getBean(Class); //必须保证容器里只有一个类型的bean</span><br></pre></td></tr></table></figure>

<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1583894948893.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1583894948893</span></p>
<h3 id="3-4-import"><a href="#3-4-import" class="headerlink" title="3.4  import"></a>3.4  import</h3><p>这个import，一般用于团队开发使用，可以将多个配置文件，导入合并为一个</p>
<p>假设，现在项目中有多个人开发，这两个人复制不同的类开发，不同的类需要注册在不同的bean中，我们可以利用import将所有人的beans.xml合并为一个总的</p>
<ul>
<li>bean.xml</li>
<li>bean2.xml</li>
<li>applicationContext.xml</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;import <span class="attribute">resource</span>=<span class="string">&quot;bean.xml&quot;</span>/&gt;</span><br><span class="line">&lt;import <span class="attribute">resource</span>=<span class="string">&quot;bean2.xml&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>使用时，直接使用总的配置就可以了</p>
<h2 id="4-属性注入"><a href="#4-属性注入" class="headerlink" title="4 属性注入"></a>4 属性注入</h2><h3 id="4-0-属性"><a href="#4-0-属性" class="headerlink" title="4.0 属性"></a>4.0 属性</h3><h4 id="propery"><a href="#propery" class="headerlink" title="==propery=="></a>==propery==</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;34&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;小明&#x27;, age=&#x27;34&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="p"><a href="#p" class="headerlink" title="==p=="></a>==p==</h4><p><strong>参考4.3</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">p:tId</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:tName</span>=<span class="string">&quot;于老师&quot;</span>/&gt;</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">测试结果：Teacher&#123;tId=2, tName=&#x27;于老师&#x27;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">p:tId</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:tName</span>=<span class="string">&quot;于老师&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2010/1/1&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;tea&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="construtor"><a href="#construtor" class="headerlink" title="==construtor=="></a>==construtor==</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--按照顺序，如果没有name,要按照顺序--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;constructor-arg value=&quot;小亮&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;constructor-arg value=&quot;23&quot;/&gt;--&gt;</span></span><br><span class="line">    --------------------------------</span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;23&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;小亮&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line"><span class="comment">&lt;!--测试结果：Student&#123;id=3, name=&#x27;小亮&#x27;, age=&#x27;23&#x27;&#125;--&gt;</span></span><br><span class="line">测试结果：Student&#123;id=3, name=&#x27;23&#x27;, age=&#x27;小亮&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="null"><a href="#null" class="headerlink" title="==null=="></a>==null==</h4><ul>
<li>方法一：空字符串</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;小明&#x27;, age=&#x27;&#x27;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>方法二：不写</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;小明&#x27;, age=&#x27;null&#x27;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>方法三：<null></null></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">p:tId</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:tName</span>=<span class="string">&quot;于老师&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">null</span>/&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2010/1/1&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;null&#x27;, birth=Fri Jan 01 00:00:00 CST 2010&#125;</span><br></pre></td></tr></table></figure>

<h4 id="innerBean"><a href="#innerBean" class="headerlink" title="==innerBean=="></a>==innerBean==</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">value</span>=<span class="string">&quot;01&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;tea&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">p:tId</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:tName</span>=<span class="string">&quot;于老师&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;小明&#x27;, tea=&#x27;Teacher&#123;tId=2, tName=&#x27;于老师&#x27;&#125;&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="extends"><a href="#extends" class="headerlink" title="==extends=="></a>==extends==</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;于老师&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">p:birth</span>=<span class="string">&quot;2019/2/2&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">parent</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=2, name=&#x27;于老师&#x27;, birth=Sat Feb 02 00:00:00 CST 2019&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;于老师&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;01&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;小明&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">p:birth</span>=<span class="string">&quot;2019/2/2&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">测试结果：Student&#123;id=1, name=&#x27;小明&#x27;, birth=Sat Feb 02 00:00:00 CST 2019&#125;</span><br></pre></td></tr></table></figure>

<h4 id="factory"><a href="#factory" class="headerlink" title="==factory=="></a>==factory==</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--日期工厂--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;java.text.SimpleDateFormat&quot;</span> <span class="attr">id</span>=<span class="string">&quot;dateFormat&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;yyyy-MM-dd&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--就像对象里的方法--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">factory-bean</span>=<span class="string">&quot;dateFormat&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;parse&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;2010-2-2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="strToDate-帮助文档7-4"><a href="#strToDate-帮助文档7-4" class="headerlink" title="==strToDate== 帮助文档7.4"></a>==strToDate== 帮助文档7.4</h4><h4 id="set"><a href="#set" class="headerlink" title="==set=="></a>==set==</h4><p><strong>参考4.2</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Student[] students;</span><br><span class="line"><span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line"><span class="keyword">private</span> Set&lt;Student&gt; students;</span><br><span class="line"><span class="keyword">private</span> Map&lt;Integer,String&gt; stringMap;</span><br></pre></td></tr></table></figure>

<h4 id="autowire"><a href="#autowire" class="headerlink" title="==autowire=="></a>==autowire==</h4><ul>
<li>方式一：当autowire=”default”时，由default-autowire决定</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span></span></span><br><span class="line"><span class="tag">       </span></span><br><span class="line"><span class="tag">        <span class="attr">default-autowire</span>=<span class="string">&quot;constructor&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;02&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;于老师&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Teachers&quot;</span> <span class="attr">id</span>=<span class="string">&quot;teachers&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.model.Student&quot;</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;default&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2012/3/3&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方式二：autowire的类型：default，byType，byName（参考5），constructor，no</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//constructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">    <span class="keyword">private</span> Teacher teacher;</span><br><span class="line">	<span class="comment">//必须有teacher的构造器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(Teacher teacher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.teacher = teacher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">&lt;bean class=<span class="string">&quot;com.aaa.model.Teacher&quot;</span> p:id=<span class="string">&quot;02&quot;</span> p:name=<span class="string">&quot;于老师&quot;</span>/&gt;</span><br><span class="line">&lt;bean class=<span class="string">&quot;com.aaa.model.Student&quot;</span> id=<span class="string">&quot;student&quot;</span> autowire=<span class="string">&quot;constructor&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;id&quot;</span> value=<span class="string">&quot;1&quot;</span>/&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;name&quot;</span> value=<span class="string">&quot;小明&quot;</span>/&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;birth&quot;</span> value=<span class="string">&quot;2012/3/3&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>



<hr>
<p><strong>创建对象的时候，向类里面的属性设置值。</strong></p>
<p>三种方式实现属性注入</p>
<p>（1）使用set方法（常用）</p>
<p>（2）使用带参的构造函数</p>
<p>（3）使用接口</p>
<p><strong>spring只支持前两张方式的注入</strong></p>
<h3 id="4-1-构造器注入"><a href="#4-1-构造器注入" class="headerlink" title="4.1  构造器注入"></a>4.1  构造器注入</h3><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【<span class="number">2.4</span>  IOC创建对象的方式】</span><br><span class="line">&lt;bean id<span class="operator">=</span><span class="string">&quot;user&quot;</span> class<span class="operator">=</span><span class="string">&quot;com.yan.pojo.User&quot;</span>&gt;</span><br><span class="line">    &lt;constructor-arg name<span class="operator">=</span><span class="string">&quot;name&quot;</span> value<span class="operator">=</span><span class="string">&quot;CodeTiger&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-set方式注入【重点】"><a href="#4-2-set方式注入【重点】" class="headerlink" title="4.2  set方式注入【重点】"></a>4.2  set方式注入【重点】</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;address&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.pojo.Address&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;河南&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;getName&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--普通值注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;妹子&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--对象引入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数组--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>西游记<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>红楼梦<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>三国演义<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--List--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbys&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>看书<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>打球<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>跑步<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--map--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;12345&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;56789&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;34435&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--set--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;games&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>王者荣耀<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>植物大战僵尸<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置空值：两种--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name=&quot;wife&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;null/&gt;</span></span><br><span class="line"><span class="comment">    &lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--properties--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span>安徽<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--测试结果--&gt;</span><br><span class="line">Student&#123;</span><br><span class="line">    name=&#x27;妹子&#x27;, </span><br><span class="line">    <span class="selector-tag">address</span>=<span class="selector-tag">Address</span>&#123;<span class="selector-tag">address</span>=&#x27;河南&#x27;&#125;, </span><br><span class="line">    books=<span class="selector-attr">[西游记, 红楼梦, 三国演义]</span>, </span><br><span class="line">    hobbys=<span class="selector-attr">[看书, 打球, 跑步]</span>, </span><br><span class="line">    card=&#123;<span class="number">1</span>=<span class="number">12345</span>, <span class="number">2</span>=<span class="number">56789</span>, <span class="number">3</span>=<span class="number">34435</span>&#125;, </span><br><span class="line">    games=<span class="selector-attr">[王者荣耀, 植物大战僵尸]</span>, </span><br><span class="line">    wife=&#x27;&#x27;, </span><br><span class="line">    info=&#123;<span class="number">3</span>=北京, <span class="number">2</span>=上海, <span class="number">1</span>=安徽&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-p名称空间注入"><a href="#4-3-p名称空间注入" class="headerlink" title="4.3  p名称空间注入"></a>4.3  p名称空间注入</h3><p>可以使用  <strong>P命名空间和C命名空间</strong>   注入</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--灰色表示还没有使用--&gt;</span><br><span class="line">xmlns:p=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span><br><span class="line">xmlns:c=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="attr">--P</span>命名空间注入，可以直接注入属性的值：property--&gt;</span><br><span class="line">&lt;bean id=&quot;getUser&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.User</span>&quot; <span class="selector-tag">p</span>:name=<span class="string">&quot;妹子&quot;</span> p:age=<span class="string">&quot;12&quot;</span>/&gt;</span><br><span class="line">&lt;!--C命名空间注入，通过构造器：constructor--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;getUser2&quot;</span> class=<span class="string">&quot;com.yan.pojo.User&quot;</span> c:age=<span class="string">&quot;15&quot;</span> c:name=<span class="string">&quot;小子&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--不需要强制转换--&gt;</span><br><span class="line">User getUser = applicationContext<span class="selector-class">.getBean</span>(&quot;getUser&quot;, User<span class="selector-class">.class</span>);</span><br></pre></td></tr></table></figure>

<p>注意点：P命名和C命名空间不能直接使用，需要导入xml约束！</p>
<h3 id="4-4-bean的作用域"><a href="#4-4-bean的作用域" class="headerlink" title="4.4  bean的作用域"></a>4.4  bean的作用域</h3><p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579622360138.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579622360138</span></p>
<h4 id="1-单例模式（Spring默认机制）：共享一个对象"><a href="#1-单例模式（Spring默认机制）：共享一个对象" class="headerlink" title="1.单例模式（Spring默认机制）：共享一个对象"></a>1.单例模式（Spring默认机制）：共享一个对象</h4><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579622667038.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579622667038</span>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean <span class="attribute">id</span>=<span class="string">&quot;getUser&quot;</span> <span class="attribute">class</span>=<span class="string">&quot;com.yan.pojo.User&quot;</span> p:<span class="attribute">name</span>=<span class="string">&quot;妹子&quot;</span> p:<span class="attribute">age</span>=<span class="string">&quot;12&quot;</span> <span class="attribute">scope</span>=<span class="string">&quot;singleton&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">测试：</span><br><span class="line"><span class="keyword">User</span> getUser = applicationContext.getBean(&quot;getUser&quot;, <span class="keyword">User</span>.<span class="keyword">class</span>);</span><br><span class="line"><span class="keyword">User</span> getUser2 = applicationContext.getBean(&quot;getUser&quot;, <span class="keyword">User</span>.<span class="keyword">class</span>);</span><br><span class="line"><span class="keyword">System</span>.<span class="keyword">out</span>.println(getUser==getUser2);</span><br><span class="line">测试结果：<span class="keyword">true</span></span><br></pre></td></tr></table></figure>



<h4 id="2-原型模式：每次从容器中get的时候，都会产生一个新对象"><a href="#2-原型模式：每次从容器中get的时候，都会产生一个新对象" class="headerlink" title="2.原型模式：每次从容器中get的时候，都会产生一个新对象"></a>2.原型模式：每次从容器中get的时候，都会产生一个新对象</h4><p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579623178387.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579623178387</span></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean <span class="attribute">id</span>=<span class="string">&quot;getUser&quot;</span> <span class="attribute">class</span>=<span class="string">&quot;com.yan.pojo.User&quot;</span> p:<span class="attribute">name</span>=<span class="string">&quot;妹子&quot;</span> p:<span class="attribute">age</span>=<span class="string">&quot;12&quot;</span> <span class="attribute">sope</span>=<span class="string">&quot;prototype&quot;</span>/&gt;</span><br><span class="line">测试结果：<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h4 id="3-其余的request，session，applicable-这些只能在web开发中使用！"><a href="#3-其余的request，session，applicable-这些只能在web开发中使用！" class="headerlink" title="3. 其余的request，session，applicable  这些只能在web开发中使用！"></a>3. 其余的request，session，applicable  这些只能在web开发中使用！</h4><h2 id="5-Bean的装配"><a href="#5-Bean的装配" class="headerlink" title="5 Bean的装配"></a>5 Bean的装配</h2><ul>
<li>自动装配是spring满足bean依赖一种方式！</li>
<li>spring会在上下文中自动寻找，并自动给bean装配属性！</li>
<li> Spring自动装配是通过反射机制来实现的。 </li>
</ul>
<p><strong>在spring中有三种装配的方式</strong></p>
<ol>
<li>在xml中显示的配置</li>
<li>在Java中显示配置</li>
<li>隐式的自动装配bean【重要】</li>
</ol>
<h3 id="5-1-在xml中显示的配置"><a href="#5-1-在xml中显示的配置" class="headerlink" title="5.1  在xml中显示的配置"></a>5.1  在xml中显示的配置</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;dog&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Dog</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;cat&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Cat</span>&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;people&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.People</span>&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;苇子&quot;/&gt;</span><br><span class="line">    &lt;property name=&quot;cat&quot; ref=&quot;cat&quot;/&gt;</span><br><span class="line">    &lt;property name=&quot;dog&quot; ref=&quot;dog&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-ByName-自动装配"><a href="#5-2-ByName-自动装配" class="headerlink" title="5.2 ByName 自动装配"></a>5.2 ByName 自动装配</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;dog&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Dog</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;cat&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Cat</span>&quot;/&gt;</span><br><span class="line">&lt;!<span class="attr">--byName</span>：会自动在容器上下文中查找，和自己对象set方法名后面的值对应的beanid--&gt;</span><br><span class="line">&lt;bean id=&quot;people&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.People</span>&quot; autowire=&quot;byName&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;苇子&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-ByType-自动装配"><a href="#5-3-ByType-自动装配" class="headerlink" title="5.3  ByType 自动装配"></a>5.3  ByType 自动装配</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;dog&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Dog</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;cat&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Cat</span>&quot;/&gt;</span><br><span class="line">&lt;!<span class="attr">--byType</span>：会自动在容器上下文中查找，和自己对象属性类型相同的bean--&gt;</span><br><span class="line">&lt;bean id=&quot;people&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.People</span>&quot; autowire=&quot;byType&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;苇子&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>小结：</p>
<ul>
<li>byname的时候，需要保证所有bean的id唯一，并且这个bean需要和自动注入的属性的set方法的值一致！</li>
<li>bytype的时候，需要保证所有bean的class唯一，并且这个bean需要和自动注入的属性的类型一致！</li>
<li> <strong>缺点</strong>：</li>
<li>如果存在多个相同类型的bean对象，会出错；</li>
<li>如果属性为单一类型的数据，那么查找到多个关联对象会发生错误；</li>
<li>如果属性为数组或集合(泛型)类型，那么查找到多个关联对象不会发生异常。 </li>
</ul>
<h3 id="5-4-使用注解实现自动装配"><a href="#5-4-使用注解实现自动装配" class="headerlink" title="5.4  使用注解实现自动装配"></a>5.4  使用注解实现自动装配</h3><ul>
<li>jdk1.5支持的注解，spring2.5就支持注解了</li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hellowhy/p/9715063.html">注解自动装配过程</a></li>
<li>使用注解须知：<ol>
<li>导入约束：context约束</li>
<li>配置注解的支持：<font style="color:#ff0000">&lt;context:annotation-config /&gt;</font>【重要！】</li>
</ol>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;<span class="number">1.0</span>&quot; encoding=&quot;UTF-<span class="number">8</span>&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans<span class="string">&quot;</span></span><br><span class="line"><span class="string">       xmlns:xsi=&quot;</span>http://www.w3.org/<span class="number">2001</span>/XMLSchema-instance<span class="string">&quot;</span></span><br><span class="line"><span class="string">       xmlns:context=&quot;</span>http://www.springframework.org/schema/context<span class="string">&quot;</span></span><br><span class="line"><span class="string">       xsi:schemaLocation=&quot;</span>http://www.springframework.org/schema/beans</span><br><span class="line">        http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context </span><br><span class="line">        http://www.springframework.org/schema/context/spring-context.xsd<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;!--开启注解的支持，如果不加，注解无效--&gt;</span></span><br><span class="line"><span class="string">    &lt;context:annotation-config /&gt;</span></span><br><span class="line"><span class="string">&lt;/beans&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h4><pre><code>1. 直接在属性上使用即可！
</code></pre>
<ol start="2">
<li>也可以在set方式上使用！</li>
<li>使用<strong>Autowired 可以不用编写set方法</strong>了，前提是这个自动装配的属性在IOC（spring）容器中存在，且符合名字byname</li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:annotation-config /&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;dog&quot;</span> class=<span class="string">&quot;com.yan.pojo.Dog&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;cat&quot;</span> class=<span class="string">&quot;com.yan.pojo.Cat&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;people&quot;</span> class=<span class="string">&quot;com.yan.pojo.People&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;name&quot;</span> value=<span class="string">&quot;妹子&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class People &#123;</span><br><span class="line">      <span class="keyword">@Autowired</span></span><br><span class="line">      private Cat cat;<span class="comment">/*第一种方式*/</span></span><br><span class="line">      private Dog dog;<span class="comment">/*第二种方式*/</span></span><br><span class="line">      public Cat getCat() &#123;return cat;&#125; </span><br><span class="line">      <span class="keyword">@Autowired</span></span><br><span class="line">      public void setDog(Dog dog) &#123;this<span class="selector-class">.dog</span> = dog;&#125;</span><br><span class="line">      public Dog getDog() &#123;return dog;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Nullable-，-Autowired-required-false"><a href="#Nullable-，-Autowired-required-false" class="headerlink" title="@Nullable  ，@Autowired(required = false)"></a>@Nullable  ，@Autowired(required = false)</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一种：</span><br><span class="line"><span class="keyword">@Nullable</span>  字段标记了这个注解，说明这个字段可以为null</span><br><span class="line">public Cat(@Nullable String name) &#123;this<span class="selector-class">.name</span> = name;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第二种：</span><br><span class="line"><span class="comment">/*如果显示定义了Autowired的required的属性为false，说明这个对象可以为null*/</span></span><br><span class="line"><span class="keyword">@Autowired</span>(required = false)</span><br><span class="line">private Cat cat;</span><br></pre></td></tr></table></figure>

<h4 id="Qualifier"><a href="#Qualifier" class="headerlink" title="@Qualifier"></a>@Qualifier</h4><p>如果@Autowired自动装配的环境比较复杂，自动装配无法通过一个注解【@Autowired】完成的时候，我们可以使用@Qualifier(value = “XXX”)去配置@Autowired的使用，指定一个唯一的bean对象注入</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;cataa&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Cat</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;catbb&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.pojo</span><span class="selector-class">.Cat</span>&quot;/&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*@Autowired，@Qualifier是一对组合*/</span></span><br><span class="line"><span class="keyword">@Autowired</span></span><br><span class="line">@Qualifier(value = <span class="string">&quot;cataa&quot;</span>)</span><br><span class="line">private Cat cat;</span><br></pre></td></tr></table></figure>

<h4 id="Resource"><a href="#Resource" class="headerlink" title="@Resource"></a>@Resource</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@Resource</span>(name = <span class="string">&quot;cataa&quot;</span>)</span><br><span class="line">private Cat cat;</span><br></pre></td></tr></table></figure>



<h4 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h4><p>@Resource 和@Autowired的区别：</p>
<ul>
<li>都是用来自动装配的，都可以放在属性字段上</li>
<li>@Autowired通过byType的方式实现，而且必须要求这个对象存在，自动装配通过类型，名字</li>
<li>@Resource 默认通过byname的方式实现，如果找不到名字，则通过byType实现！如果两个都找不到的情况下，就报错！</li>
<li><strong>执行顺序不同：</strong><ul>
<li>@Autowired通过byType的方式实现</li>
<li>@Resource 默认通过byname的方式实现</li>
</ul>
</li>
</ul>
<h2 id="6-注解开发"><a href="#6-注解开发" class="headerlink" title="6  注解开发"></a>6  注解开发</h2><h3 id="6-1-bean"><a href="#6-1-bean" class="headerlink" title="6.1 bean"></a>6.1 bean</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--指定要扫描的包，这个包下的注解就会生效--&gt;</span><br><span class="line">&lt;context:component-scan base-package=<span class="string">&quot;com.yan.pojo&quot;</span> /&gt;</span><br><span class="line">&lt;context:annotation-config /&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">相对于 &lt;bean id=&quot;user&quot; class=&quot;com.yan.pojo.User&quot;/&gt;</span></span><br><span class="line"><span class="comment">@Component：组件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@Component</span></span><br><span class="line">public class User &#123;<span class="comment">/*id默认为类的小写*/</span></span><br><span class="line">      public String name = &quot;妹子&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-属性如何注入"><a href="#6-2-属性如何注入" class="headerlink" title="6.2  属性如何注入"></a>6.2  属性如何注入</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@Component</span></span><br><span class="line">public class User &#123;</span><br><span class="line">      public String name;</span><br><span class="line">    <span class="comment">/*相对于：&lt;property name=&quot;name&quot; value=&quot;&quot;/&gt;*/</span></span><br><span class="line">      <span class="keyword">@Value</span>(&quot;妹子&quot;)</span><br><span class="line">      public void setName(String name) &#123;</span><br><span class="line">            this<span class="selector-class">.name</span> = name;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-component的注解"><a href="#6-3-component的注解" class="headerlink" title="6.3 @component的注解"></a>6.3 @component的注解</h3><ol>
<li>@controller 控制器（注入服务）</li>
<li>@service 服务（注入dao）</li>
<li>@repository dao（实现dao访问）</li>
<li>@component （把普通pojo实例化到spring容器中，相当于配置文件中的<bean id class>）<br><strong>==@Component：定义Spring管理Bean==</strong></bean></li>
</ol>
<h4 id="Repository-："><a href="#Repository-：" class="headerlink" title="==@Repository==："></a>==@Repository==：</h4><p>@Component扩展，被@Repository注解的POJO类表示DAO层实现，从而见到该注解就想到DAO层实现，使用方式和@Component相同；</p>
<h4 id="Service："><a href="#Service：" class="headerlink" title="==@Service：=="></a>==@Service：==</h4><p>@Component扩展，被@Service注解的POJO类表示Service层实现，从而见到该注解就想到Service层实现，使用方式和@Component相同；</p>
<h4 id="Controller："><a href="#Controller：" class="headerlink" title="==@Controller：=="></a>==@Controller：==</h4><p>@Component扩展，被@Controller注解的类表示Web层实现，从而见到该注解就想到Web层实现，使用方式和@Component相同；</p>
<ul>
<li><p>==@Component,@Service,@Controller,@Repository注解的类，并把这些类纳入进spring容器中管理。== </p>
</li>
<li><p>下面写这个是引入component的扫描组件 </p>
</li>
<li><p>==&lt;context:component-scan base-package=”com.mmnc”&gt;==    </p>
<ul>
<li><p>其中base-package为需要扫描的包（含所有子包） </p>
<ol>
<li>@Service用于标注业务层组件 </li>
<li>@Controller用于标注控制层组件(如struts中的action) </li>
<li>@Repository用于标注数据访问组件，即DAO组件. </li>
<li>@Component泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。</li>
</ol>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123; &#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123; &#125; getBean的默认名称是类名（头字母小写），</span><br><span class="line">如果想自定义，可以Service(“***”)，这样来指定，这种bean默认是单例的，如果想改变，可以使用<span class="meta">@Service(“beanName”)</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">@Scope(“prototype”)</span>来改变。</span><br><span class="line">可以使用以下方式指定初始化方法和销毁方法（方法名任意）： </span><br><span class="line"><span class="meta">@PostConstruct</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123; &#125; </span><br></pre></td></tr></table></figure>

<h3 id="6-4-层注解"><a href="#6-4-层注解" class="headerlink" title="6.4 层注解"></a>6.4 层注解</h3><h4 id="类注解"><a href="#类注解" class="headerlink" title="==类注解=="></a>==类注解==</h4><ol>
<li><strong>@Repository dao</strong></li>
<li><strong>@Component model</strong></li>
<li><strong>@Service</strong><br><strong>service</strong></li>
<li><strong>@Controller controll</strong></li>
</ol>
<ul>
<li>这个四个可以互换，为了区分层见名知意才分层的。</li>
<li>以上四个注解和包扫描仪在api里5.10第一节和第二节</li>
</ul>
<h4 id="属性或方法注解"><a href="#属性或方法注解" class="headerlink" title="==属性或方法注解=="></a>==属性或方法注解==</h4><ol>
<li><p>==<strong>Spring</strong>== (在帮助文档里5.9里查看)。</p>
<ul>
<li><p><strong>@Autowired</strong>   自动装配<br>（如果有多个实现类，则无法自动装配）</p>
</li>
<li><p>```css</p>
<!--出现的异常-->
<p>No unique bean of type [com.aaa.dao.StudentDao] is defined: expected single matching bean but found 2: [studentDaoImpl, studentDaoImpl2]</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   - **<span class="meta">@Qualifier</span>(<span class="string">&quot;&quot;</span>)**  指定调用那个类型的对象。</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> ==**jdk**==</span><br><span class="line"></span><br><span class="line">   - **<span class="meta">@Resource</span>** </span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> **Spring和jdk是等价的（两个StudentDaoImpl实现类）** </span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="comment">//第一种：Spring</span></span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">&quot;one&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDaoImpl</span> <span class="keyword">implements</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Student stu)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;添加了&quot;</span>+stu.getStuName()+<span class="string">&quot;学生1&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">&quot;two&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDaoImpl2</span> <span class="keyword">implements</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Student stu)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;添加了&quot;</span>+stu.getStuName()+<span class="string">&quot;学生2&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier</span>(<span class="string">&quot;one&quot;</span>)</span><br><span class="line">	<span class="keyword">private</span> StudentDao sDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种：jdk</span></span><br><span class="line"><span class="comment">//两个实现类同上</span></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">StudentService</span> &#123;</span><br><span class="line">	<span class="comment">/*@Autowired</span></span><br><span class="line"><span class="comment">	@Qualifier(&quot;one&quot;)*/</span></span><br><span class="line">	<span class="meta">@Resource(name=&quot;two&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> StudentDao sDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>@Component有几个衍生注解，我们在web开发中，会按照mvc三层架构分层！</p>
<ul>
<li>dao  【@Repository】</li>
<li>service   【@Service】</li>
<li>controller   【@Controller】</li>
<li>这四个注解功能都是一样的，都是代表将某个类注册到spring中，装配Bean</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@Component</span></span><br><span class="line">public class User &#123;<span class="comment">/*id默认为类的小写*/</span></span><br><span class="line">      public String name = &quot;妹子&quot;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@Controller</span></span><br><span class="line">public class Controller &#123;</span><br><span class="line">      public String name=&quot;我是Controller&quot;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@Repository</span></span><br><span class="line">public class UserDao &#123;</span><br><span class="line">      public String name=&quot;我是UserDao&quot;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@Service</span></span><br><span class="line">public class UserService &#123;</span><br><span class="line">      public String name=&quot;我是service&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&lt;!--指定要扫描的包，这个包下的注解就会生效--&gt;</span><br><span class="line">&lt;context:component-scan base-package=<span class="string">&quot;com.yan&quot;</span> /&gt;</span><br><span class="line">&lt;context:annotation-config /&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">测试：</span><br><span class="line">User user = applicationContext<span class="selector-class">.getBean</span>(&quot;user&quot;, User<span class="selector-class">.class</span>);</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(user<span class="selector-class">.name</span>);</span><br><span class="line">Controller controller = applicationContext<span class="selector-class">.getBean</span>(&quot;controller&quot;, Controller<span class="selector-class">.class</span>);</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(controller<span class="selector-class">.name</span>);</span><br><span class="line">UserDao userDao = applicationContext<span class="selector-class">.getBean</span>(&quot;userDao&quot;, UserDao<span class="selector-class">.class</span>);</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(userDao<span class="selector-class">.name</span>);</span><br><span class="line">UserService userService = applicationContext<span class="selector-class">.getBean</span>(&quot;userService&quot;, UserService<span class="selector-class">.class</span>);</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(userService<span class="selector-class">.name</span>);</span><br></pre></td></tr></table></figure>

<h3 id="6-5-AOP-注解"><a href="#6-5-AOP-注解" class="headerlink" title="6.5 AOP 注解"></a>6.5 AOP 注解</h3><h4 id="切面注解"><a href="#切面注解" class="headerlink" title="==切面注解=="></a>==切面注解==</h4><ul>
<li>@Aspect</li>
</ul>
<h4 id="增强注解"><a href="#增强注解" class="headerlink" title="==增强注解=="></a>==增强注解==</h4><ul>
<li><p>@Before</p>
</li>
<li><p>@After</p>
</li>
<li><p>@AfterReturnning</p>
</li>
<li><p>@ AfterThrow</p>
</li>
<li><p>@Around</p>
</li>
</ul>
<h4 id="切点注解"><a href="#切点注解" class="headerlink" title="==切点注解=="></a>==切点注解==</h4><ul>
<li>@Point</li>
</ul>
<h4 id="顺序注解"><a href="#顺序注解" class="headerlink" title="==顺序注解=="></a>==顺序注解==</h4><ul>
<li>@Order(数字)    数字越大优先级越低，只能用在类型上面，如果是方法跟方法名有关系</li>
</ul>
<h4 id="AOP-实现三种方式"><a href="#AOP-实现三种方式" class="headerlink" title="==AOP 实现三种方式=="></a>==AOP 实现三种方式==</h4><p><strong>（参考：9.3 使用Spring实现AOP）</strong> </p>
<h5 id="1-XmI"><a href="#1-XmI" class="headerlink" title="==1 XmI=="></a>==1 XmI==</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置代理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.xml.dao.impl.StudentDaoImpl&quot;</span> <span class="attr">id</span>=<span class="string">&quot;studentDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置增强  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.xml.advice.AfterAdvice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;after&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.xml.advice.BeforeAdvice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;before&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.xml.advice.RoundAdvice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;round&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.xml.advice.ThrowAdvice&quot;</span> <span class="attr">id</span>=<span class="string">&quot;throw&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置增强与切点的连接 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.xml.dao.impl.StudentDaoImpl.*(..))&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;after&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;round&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;throw&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-注解"><a href="#2-注解" class="headerlink" title="==2 注解=="></a>==2 注解==</h5><ul>
<li>dao层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Student stu)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Student stu)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">StudentDao</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Student stu)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;添加了&quot;</span>+stu.getStuName()+<span class="string">&quot;学生1&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;你好&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Student stu)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;删除了&quot;</span>+stu.getStuName()+<span class="string">&quot;学生1&quot;</span>+<span class="number">1</span>/<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>aspect层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">//核心文件怎么知道这个类哪？          //@Before;@After</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLogAspect</span> &#123;</span><br><span class="line">	<span class="comment">//切点与增强的联系</span></span><br><span class="line">	<span class="meta">@Before(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint jpt)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;------开始日志----------&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@After(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">(JoinPoint jpt)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;---------结束日志--------&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>          <span class="comment">//@Around</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTransAspect</span> &#123;</span><br><span class="line">	<span class="meta">@Around(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint pjp)</span><span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		<span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span><span class="literal">null</span>;</span><br><span class="line">		System.out.println(<span class="string">&quot;开始事务-----------&quot;</span>);</span><br><span class="line"><span class="comment">//		放行</span></span><br><span class="line">		o = pjp.proceed();</span><br><span class="line">		System.out.println(<span class="string">&quot;结束事务-----------&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>          <span class="comment">//@AfterReturning；@AfterThrowing</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAdvie</span> &#123;</span><br><span class="line">	<span class="meta">@AfterReturning(pointcut=&quot;execution(* com.xml.dao.impl.*.*</span></span><br><span class="line"><span class="meta">                    (..))&quot;,returning=&quot;o&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturn</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;====后返回通知，值是：&quot;</span>+o+<span class="string">&quot;====&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@AfterThrowing(pointcut=&quot;execution(* com.xml.dao.impl.*.*(..))&quot;,throwing=&quot;E&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrow</span><span class="params">(Exception E)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;----后异常通知，值是：&quot;</span>+E+<span class="string">&quot;----&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>          <span class="comment">//@Pointcut</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAdvie</span> &#123;</span><br><span class="line">	<span class="meta">@AfterReturning(pointcut=&quot;hehe()&quot;,returning=&quot;o&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturn</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;====后返回通知，值是：&quot;</span>+o+<span class="string">&quot;====&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@AfterThrowing(pointcut=&quot;hehe()&quot;,throwing=&quot;E&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrow</span><span class="params">(Exception E)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;----后异常通知，值是：&quot;</span>+E+<span class="string">&quot;----&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hehe</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------</span><br><span class="line">    				<span class="comment">//@Order,对于两个重复的</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//核心文件怎么知道这个类哪？</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(10)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLogAspect</span> &#123;</span><br><span class="line">	<span class="meta">@Before(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">(JoinPoint jpt)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;------开始日志a----------&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(3)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTransAspect</span> &#123;</span><br><span class="line">	<span class="meta">@Before(&quot;execution(* com.xml.dao.impl.*.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">b</span><span class="params">(JoinPoint jpt)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;------开始日志b----------&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>xml配置层</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 切面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--扫描包  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Order顺序不同</span></span><br><span class="line"><span class="comment">//第一种</span></span><br><span class="line">------开始日志b----------</span><br><span class="line">开始事务-----------</span><br><span class="line">------开始日志a----------</span><br><span class="line">添加了小明学生<span class="number">1</span></span><br><span class="line">====后返回通知，值是：你好====</span><br><span class="line">---------结束日志--------</span><br><span class="line">结束事务-----------</span><br><span class="line"><span class="comment">//第二种</span></span><br><span class="line">------开始日志a----------</span><br><span class="line">------开始日志b----------</span><br><span class="line">开始事务-----------</span><br><span class="line">添加了小明学生<span class="number">1</span></span><br><span class="line">====后返回通知，值是：你好====</span><br><span class="line">结束事务-----------</span><br><span class="line">---------结束日志--------</span><br></pre></td></tr></table></figure>

<h5 id="3-schema"><a href="#3-schema" class="headerlink" title="==3 schema=="></a>==3 schema==</h5><p>Dao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(String name)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">StudentDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;增加：&quot;</span>+name+<span class="string">&quot;同学&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;欢迎&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;删除:&quot;</span>+name+<span class="string">&quot;同学&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Aspect（没有注解）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoggingAspect</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeLog</span><span class="params">(JoinPoint j)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始日志---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterLog</span><span class="params">(JoinPoint j)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;结束日志---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturn</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后返回值：&quot;</span>+o);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransAspect</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">round</span><span class="params">(ProceedingJoinPoint j)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span><span class="literal">null</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始事务======&quot;</span>);</span><br><span class="line">        o = j.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;结束事务======&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrowAspect</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">throwing</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;出现的异常：&quot;</span>+e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>XML</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置代理对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.dao.impl.StudentDaoImpl&quot;</span> <span class="attr">id</span>=<span class="string">&quot;studentDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置Aspect--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.aspect.LoggingAspect&quot;</span> <span class="attr">id</span>=<span class="string">&quot;loggingAspect&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.aspect.TransAspect&quot;</span> <span class="attr">id</span>=<span class="string">&quot;transAspect&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.aspect.TrowAspect&quot;</span> <span class="attr">id</span>=<span class="string">&quot;trowAspect&quot;</span>/&gt;</span></span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line"><span class="comment">&lt;!--以上可以使用扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.aaa&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--还有加上能让它扫描到的注解--&gt;</span></span><br><span class="line">@Component；@Repository</span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line"><span class="comment">&lt;!--切面与切点的联系--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;point&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution</span></span></span><br><span class="line"><span class="string"><span class="tag">                                         (* com.aaa.dao.impl.StudentDaoImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;loggingAspect&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;beforeLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;afterReturn&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span> <span class="attr">returning</span>=<span class="string">&quot;o&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;transAspect&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;round&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;trowAspect&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">&quot;throwing&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span> <span class="attr">throwing</span>=<span class="string">&quot;e&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">ApplicationContext context=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;Context.xml&quot;</span>);</span><br><span class="line"><span class="type">StudentDao</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(StudentDao.class);</span><br><span class="line">bean.add(<span class="string">&quot;小亮&quot;</span>);       </span><br></pre></td></tr></table></figure>

<h3 id="6-6-自动装配-5-4"><a href="#6-6-自动装配-5-4" class="headerlink" title="6.6  自动装配   (5.4)"></a>6.6  自动装配   (5.4)</h3><h3 id="6-7-作用域"><a href="#6-7-作用域" class="headerlink" title="6.7  作用域"></a>6.7  作用域</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@Component</span></span><br><span class="line">@Scope(<span class="string">&quot;singleton&quot;</span>)</span><br><span class="line">public class User &#123;</span><br><span class="line">      public String name;</span><br><span class="line">      <span class="comment">/*相对于：&lt;property name=&quot;name&quot; value=&quot;&quot;/&gt;*/</span></span><br><span class="line">      <span class="keyword">@Value</span>(&quot;妹子&quot;)</span><br><span class="line">      public void setName(String name) &#123;</span><br><span class="line">            this<span class="selector-class">.name</span> = name;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-8-小结"><a href="#6-8-小结" class="headerlink" title="6.8  小结"></a>6.8  小结</h3><ul>
<li><strong>xml与注解：</strong> <ul>
<li>xml更加万能，适用于任何场合！维护简单方便</li>
<li>注解不是自己类使用不了，维护相对复杂！</li>
</ul>
</li>
<li><strong>xml与注解最佳实践：</strong><ul>
<li>xml用来管理bean；</li>
<li>注解只负责完成属性的注入；</li>
<li>我们在使用的过程中，只需要注意一个问题：必须让注解生效，就需要开启注解的支持</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--首先扫描到包，再让包里的注解生效--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.yan&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="7-使用Java的方式替换Spring的XML配置"><a href="#7-使用Java的方式替换Spring的XML配置" class="headerlink" title="7 使用Java的方式替换Spring的XML配置"></a>7 使用Java的方式替换Spring的XML配置</h2><p>现在==完全不使用Spring的XML配置==，全权交给Java来做！</p>
<p>javaConfig是spring的一个子项目，非常灵活，在spring4之后，它成为了一个核心功能！</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579789873203.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1579789873203</span></p>
<h3 id="第一种：过程"><a href="#第一种：过程" class="headerlink" title="第一种：过程"></a>第一种：过程</h3><h4 id="import-标签"><a href="#import-标签" class="headerlink" title="import 标签"></a>import 标签</h4><h5 id="1-Dao层"><a href="#1-Dao层" class="headerlink" title="1 Dao层"></a>1 Dao层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;添加一位同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;删除一位同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-xml配置"><a href="#2-xml配置" class="headerlink" title="2 xml配置"></a>2 xml配置</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--applicationContext.xml--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="attr">....</span></span></span><br><span class="line"><span class="tag">	&lt;<span class="attr">import</span> <span class="attr">resource</span>=<span class="string">&quot;Context.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">&lt;!--Context.xml--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	&lt;<span class="attr">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.dao.impl.EmpDaoImpl&quot;</span> <span class="attr">id</span>=<span class="string">&quot;empDao&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.service.impl.EmpServiceImpl&quot;</span> <span class="attr">id</span>=<span class="string">&quot;empService&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;empDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;empDao&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.aaa.control.MyControl&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myControl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;empService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;empService&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-测试层"><a href="#3-测试层" class="headerlink" title="3 测试层"></a>3 测试层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    ApplicationContext context=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    <span class="type">MyControl</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(MyControl.class);</span><br><span class="line">    bean.add(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line">    bean.del(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="java替换xml"><a href="#java替换xml" class="headerlink" title="java替换xml"></a>java替换xml</h4><h5 id="1-MyConfig"><a href="#1-MyConfig" class="headerlink" title="1 MyConfig"></a>1 MyConfig</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(MyConfig2.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="meta">@Scope(&quot;singleton&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> Emp <span class="title function_">emp</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Emp</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig2</span> &#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> EmpDao <span class="title function_">empDao</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">EmpDaoImpl</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> EmpServiceImpl <span class="title function_">empService</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="type">EmpServiceImpl</span> <span class="variable">empServiceImpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmpServiceImpl</span>();</span><br><span class="line">		empServiceImpl.setEmpDao(empDao());</span><br><span class="line">		<span class="keyword">return</span> empServiceImpl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> MyControl <span class="title function_">myControl</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="type">MyControl</span> <span class="variable">myControl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyControl</span>();</span><br><span class="line">		myControl.setEmpService(empService());</span><br><span class="line">		<span class="keyword">return</span> myControl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    ApplicationContext context=<span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyConfig.class);</span><br><span class="line">    <span class="type">MyControl</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(MyControl.class);</span><br><span class="line">    bean.add(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line">    bean.del(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;emp&quot;</span>,Emp.class);</span><br><span class="line">    <span class="type">Emp</span> <span class="variable">emp2</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;emp&quot;</span>,Emp.class);</span><br><span class="line">    System.out.println(emp==emp2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="ComponentScan"></a>ComponentScan</h4><h5 id="1-dao层"><a href="#1-dao层" class="headerlink" title="1 dao层"></a>1 dao层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;dao1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;添加一位A同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;删除一位A同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line"><span class="meta">@Repository(&quot;dao2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;添加一位B同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;删除一位B同学&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-Service层"><a href="#2-Service层" class="headerlink" title="2 Service层"></a>2 Service层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpService</span> &#123;</span><br><span class="line">	<span class="comment">/*@Autowired</span></span><br><span class="line"><span class="comment">	@Qualifier(&quot;dao2&quot;)*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Resource(name=&quot;dao2&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> EmpDao empDao;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		empDao.add(emp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		empDao.del(emp);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-Controller层"><a href="#3-Controller层" class="headerlink" title="3 Controller层"></a>3 Controller层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyControl</span> &#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> EmpService empService;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		empService.add(emp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		empService.del(emp);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4-MyConfig层"><a href="#4-MyConfig层" class="headerlink" title="4 MyConfig层"></a>4 MyConfig层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.aaa&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-测试层"><a href="#5-测试层" class="headerlink" title="5 测试层"></a>5 测试层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    ApplicationContext context=<span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyConfig.class);</span><br><span class="line">    <span class="type">MyControl</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(MyControl.class);</span><br><span class="line">    bean.add(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line">    bean.del(<span class="keyword">new</span> <span class="title class_">Emp</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="第二种：过程"><a href="#第二种：过程" class="headerlink" title="第二种：过程"></a>第二种：过程</h3><h4 id="一个user类"><a href="#一个user类" class="headerlink" title="一个user类"></a>一个user类</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//这里这个注解的意思，就是说明这个类被spring接管了，注册到容器中</span><br><span class="line"><span class="keyword">@Component</span></span><br><span class="line">public class User &#123;</span><br><span class="line">      private String name;</span><br><span class="line">      public User() &#123;</span><br><span class="line">      &#125;</span><br><span class="line">      public User(String name) &#123;</span><br><span class="line">            this<span class="selector-class">.name</span> = name;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">@Override</span></span><br><span class="line">      public String toString() &#123;</span><br><span class="line">            return &quot;User&#123;&quot; +</span><br><span class="line">                    &quot;name=&#x27;&quot; + name + &#x27;\&#x27;&#x27; +</span><br><span class="line">                    &#x27;&#125;&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">      public String getName() &#123;</span><br><span class="line">            return name;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">@Value</span>(&quot;妹子&quot;)</span><br><span class="line">      public void setName(String name) &#123;</span><br><span class="line">            this<span class="selector-class">.name</span> = name;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="两个AppConfig类"><a href="#两个AppConfig类" class="headerlink" title="两个AppConfig类"></a>两个AppConfig类</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">第一个AppConfig：</span><br><span class="line"><span class="comment">/*AppConfig类相当于applicableContext.xml配置文件</span></span><br><span class="line"><span class="comment">&lt;beans&gt;</span></span><br><span class="line"><span class="comment">      &lt;bean id=&quot;getUser&quot; class=&quot;com.yan.pojo.User&quot;/&gt;</span></span><br><span class="line"><span class="comment">&lt;\beans&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">这里的@Configuration注解也是spring容器托管，注册到容器中，因为它本来就是一个@Component</span></span><br><span class="line"><span class="comment"> @Configuration代表这是一个配置类，就和我们之前看的app</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@Configuration</span></span><br><span class="line">//指定要扫描的包，这个包下的注解就会生效，扫描之后，这个配置文件不需要再写bean</span><br><span class="line">@ComponentScan(<span class="string">&quot;com.yan.pojo&quot;</span>)</span><br><span class="line">//导入多个配置文件到  以AppConfig2为主的配置文件中</span><br><span class="line">@Import(AppConfig2.class)</span><br><span class="line">public class AppConfig &#123;</span><br><span class="line">      <span class="comment">/*注册一个bean，就相当于之前写的一个bean标签</span></span><br><span class="line"><span class="comment">      * 这个方法的名字，就相当于bean标签中的id属性</span></span><br><span class="line"><span class="comment">      * 这个方法的返回值，就相当于bean标签中的class属性*/</span></span><br><span class="line">     <span class="comment">/* @Bean</span></span><br><span class="line"><span class="comment">      public User getUser()&#123;</span></span><br><span class="line"><span class="comment">            return new User();//就是返回要  注入  到bean的对象</span></span><br><span class="line"><span class="comment">      &#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第二个AppConfig2：</span><br><span class="line"><span class="keyword">@Component</span></span><br><span class="line">public class AppConfig2 &#123;</span><br><span class="line">      <span class="keyword">@Bean</span></span><br><span class="line">      public User getUser()&#123;</span><br><span class="line">            return new User(&quot;AppConfig2&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="测试类："><a href="#测试类：" class="headerlink" title="测试类："></a>测试类：</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*AppConfig.class：反射机制，代替了applicableContext.xml*/</span></span><br><span class="line">ApplicationContext applicationContext=new AnnotationConfigApplicationContext</span><br><span class="line">	(AppConfig2<span class="selector-class">.class</span>);</span><br><span class="line">User getUser = applicationContext<span class="selector-class">.getBean</span>(&quot;getUser&quot;, User<span class="selector-class">.class</span>);</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(getUser<span class="selector-class">.getName</span>());</span><br></pre></td></tr></table></figure>

<h3 id="小结：-1"><a href="#小结：-1" class="headerlink" title="小结："></a>小结：</h3><p>这张纯Java的配置方式，在springboot中随处可见！</p>
<h2 id="8-代理模式"><a href="#8-代理模式" class="headerlink" title="8 代理模式"></a>8 <a href="E:\note\Typora\设计模式.md">代理模式</a></h2><p>为什么要学代理模式？因为这就是<strong>springaop的底层</strong>！   面试：【springaop 和 springmvc】</p>
<p>代理模式的分类：</p>
<ul>
<li>静态代理</li>
<li>动态代理</li>
</ul>
<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1579794616440.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 80%;"><span class="image-caption">1579794616440</span>

<h3 id="8-1-静态代理"><a href="#8-1-静态代理" class="headerlink" title="8.1  静态代理"></a>8.1  静态代理</h3><p><strong>角色分析：</strong></p>
<ul>
<li>抽象角色：一般会使用接口或者抽象类来解决</li>
<li>真实角色：被代理的角色</li>
<li>代理角色：代理真实角色，代理真实角色后，我们一般会做一些附属操作</li>
<li>客户：访问代理对象的人</li>
</ul>
<p><strong>代码步骤：</strong></p>
<ol>
<li><p>接口</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//租房</span><br><span class="line">public interface Rent &#123;</span><br><span class="line">      public void rent();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>真实角色——实现类impl</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//房东	</span><br><span class="line">public class Host implements Rent&#123;</span><br><span class="line">      public void rent() &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;房东要出租房子！&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代理角色</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//代理角色——中介</span><br><span class="line">public class Proxy implements Rent&#123;</span><br><span class="line">      private Host host;       </span><br><span class="line">      public Proxy() &#123;&#125;                       </span><br><span class="line">      public Proxy(Host host) &#123;</span><br><span class="line">            this<span class="selector-class">.host</span> = host;</span><br><span class="line">      &#125;</span><br><span class="line">      public void rent() &#123;</span><br><span class="line">            seetHouse();</span><br><span class="line">            host<span class="selector-class">.rent</span>();</span><br><span class="line">            hetong();</span><br><span class="line">            fare();</span><br><span class="line">      &#125;</span><br><span class="line">      //看房</span><br><span class="line">      public void seetHouse()&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;中介带你看房&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      //签租</span><br><span class="line">      public void hetong()&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;签租赁合同&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      //收中介费</span><br><span class="line">      public void fare()&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;收中介费&quot;);</span><br><span class="line">      &#125;&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>客户端访问代理角色</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//客户</span><br><span class="line">public class Client &#123;</span><br><span class="line">      public static void <span class="selector-tag">main</span>(String<span class="selector-attr">[]</span> args) &#123;</span><br><span class="line">            //房东要租房子</span><br><span class="line">            Host host=new Host();</span><br><span class="line">//            代理，中介帮房东租房子，但是？代理角色一般会有一些附属操作！</span><br><span class="line">            Proxy proxy = new Proxy(host);</span><br><span class="line">//          你不用面对房东，直接找中介租房即可！</span><br><span class="line">            proxy<span class="selector-class">.rent</span>();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="代理模式的好处："><a href="#代理模式的好处：" class="headerlink" title="代理模式的好处："></a>代理模式的好处：</h4><ul>
<li>可以使真实角色的操作更加纯粹！不用去关注一些公共的业务</li>
<li>公共也就交给代理角色！实现了业务的分工！</li>
<li>公共业务发生扩展的时候，方便集中管理！</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>一个真实角色就会产生一个代理角色；代码量会翻倍~开发效率会变低</li>
</ul>
<h3 id="8-2-加深理解"><a href="#8-2-加深理解" class="headerlink" title="8.2 加深理解"></a>8.2 加深理解</h3><ol>
<li><p>接口</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface UserService &#123;</span><br><span class="line">      public void add();</span><br><span class="line">      public void delete();</span><br><span class="line">      public void update();</span><br><span class="line">      public void query();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>真实角色——实现类impl</p>
<p><font style="color:#ff0000">改动原有的业务代码，在公司中是大忌！</font></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//真实角色————在使用方法前，说明这是一个什么方法</span><br><span class="line">public class UserServiceImpl implements UserService &#123;</span><br><span class="line">      public void add() &#123;</span><br><span class="line">            <span class="comment">/*如果在每一个方法的这个地方，添加这句话，改变了原有的代码，非常麻烦，所有使用代理角色，实现公共操作*/</span></span><br><span class="line">            <span class="comment">/*System.out.println(&quot;这是一个add方法&quot;);*/</span></span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;添加一个账号&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      public void delete() &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;删除一个账号&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      public void update() &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;更新一个账号&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      public void query() &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;查找一个账号&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代理角色</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class UserServiceProxy implements UserService &#123;</span><br><span class="line">      private UserServiceImpl userService;</span><br><span class="line">      <span class="comment">/*spring不建议使用构造方法，建议注入一个对象，使用如下：*/</span></span><br><span class="line">      public void setUserService(UserServiceImpl userService) &#123;</span><br><span class="line">            this<span class="selector-class">.userService</span> = userService;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      public void add() &#123;</span><br><span class="line">            log(&quot;add&quot;);</span><br><span class="line">            userService<span class="selector-class">.add</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      public void delete() &#123;</span><br><span class="line">            log(&quot;delete&quot;);</span><br><span class="line">            userService<span class="selector-class">.delete</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      public void update() &#123;</span><br><span class="line">            log(&quot;update&quot;);</span><br><span class="line">            userService<span class="selector-class">.update</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      public void query() &#123;</span><br><span class="line">            log(&quot;query&quot;);</span><br><span class="line">            userService<span class="selector-class">.query</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/*日志方法：公共东西写入一个方法*/</span></span><br><span class="line">      public void log(String msg)&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;这是一个&quot;+msg+&quot;方法&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>客户端访问代理角色</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UserServiceImpl userService=new UserServiceImpl();</span><br><span class="line">Proxy proxy = new Proxy();</span><br><span class="line">proxy<span class="selector-class">.setUserService</span>(userService);</span><br><span class="line">proxy<span class="selector-class">.add</span>();</span><br></pre></td></tr></table></figure>

<p><strong>聊聊AOP</strong></p>
</li>
</ol>
<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1580140505432.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom:80%;"><span class="image-caption">1580140505432</span>



<h3 id="8-3-动态代理"><a href="#8-3-动态代理" class="headerlink" title="8.3  动态代理"></a>8.3  动态代理</h3><ul>
<li>动态代理和静态代理角色一样</li>
<li>动态代理的代理类是动态生成的，不是我们直接写好的</li>
<li>动态代理分为两大类：基于接口的动态代理，基于类的动态代理<ul>
<li>基于接口：JDK动态代理【我们在这里使用】</li>
<li>基于类：cjlib</li>
<li>Java字节码实现：javasist</li>
</ul>
</li>
</ul>
<p><strong><font style="color:#ff0000"> java动态代理机制中有两个重要的类和接口InvocationHandler（接口）和Proxy（类），这一个类Proxy和接口InvocationHandler是我们实现动态代理的核心； </font></strong></p>
<h4 id="1-InvocationHandler-调用处理程序"><a href="#1-InvocationHandler-调用处理程序" class="headerlink" title="1. InvocationHandler    调用处理程序"></a>1. InvocationHandler    调用处理程序</h4><ul>
<li><code>InvocationHandler</code><ul>
<li>是由代理实例的调用处理程序实现的接口。</li>
<li>每个代理实例都有一个关联的调用处理程序。  </li>
<li>当在代理实例上调用方法时，方法调用将被编码并分派到其调用处理程序的<code>invoke</code>方法。 </li>
<li> java中InvocationHandler 用于实现代理。==<strong>( 自动生成代理类！）</strong>==</li>
</ul>
</li>
</ul>
<h4 id="2-Proxy-代理"><a href="#2-Proxy-代理" class="headerlink" title="2. Proxy   代理"></a>2. Proxy   代理</h4><p>==<strong>InvocationHandler调用处理程序类</strong>==</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.InvocationHandler</span>;</span><br><span class="line">import java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>;</span><br><span class="line">import java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Proxy</span>;</span><br><span class="line">//等我们会用这个类，自动生成代理类！——————InvocationHandler调用处理程序类</span><br><span class="line">//这个类只做两件事：生成代理类，处理代理实例</span><br><span class="line">public class ProxyInvocationHandler implements InvocationHandler &#123;</span><br><span class="line">      //被代理的接口</span><br><span class="line">      private Rent rent;</span><br><span class="line">      public void setRent(Rent rent) &#123;</span><br><span class="line">            this<span class="selector-class">.rent</span> = rent;</span><br><span class="line">      &#125;</span><br><span class="line">      //生成得到代理类</span><br><span class="line">      public <span class="selector-tag">Object</span> getProxy()&#123;</span><br><span class="line">            //newProxyInstance方法用来创建一个对象的代理对象——代理实例</span><br><span class="line">            return Proxy<span class="selector-class">.newProxyInstance</span>(this<span class="selector-class">.getClass</span>()<span class="selector-class">.getClassLoader</span>(),</span><br><span class="line">            	rent<span class="selector-class">.getClass</span>()<span class="selector-class">.getInterfaces</span>(),this);</span><br><span class="line">      &#125;</span><br><span class="line">      //处理代理实例，并返回结果</span><br><span class="line">      public <span class="selector-tag">Object</span> invoke(<span class="selector-tag">Object</span> proxy, Method method, <span class="selector-tag">Object</span><span class="selector-attr">[]</span> args) </span><br><span class="line">      	throws Throwable &#123;</span><br><span class="line">            seetHost();</span><br><span class="line">            //动态代理的本质，就是使用反射机制实现！</span><br><span class="line">            <span class="selector-tag">Object</span> invoke = method<span class="selector-class">.invoke</span>(rent, args);</span><br><span class="line">            fare();</span><br><span class="line">            return invoke;</span><br><span class="line">      &#125;</span><br><span class="line">      public void seetHost()&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;中介看房&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      public void fare()&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;买房&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font style="color:#ff0000">Client</font></strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Client &#123;</span><br><span class="line">      public static void <span class="selector-tag">main</span>(String<span class="selector-attr">[]</span> args) &#123;</span><br><span class="line">            //真实角色</span><br><span class="line">            Host host=new Host();</span><br><span class="line">            //代理角色：现在没有</span><br><span class="line">            ProxyInvocationHandler invocationHandler = new ProxyInvocationHandler();</span><br><span class="line">            //通过调用处理程序 处理角色，来处理我们要调用的接口对象！</span><br><span class="line">            //Rent rent=new Host();多态</span><br><span class="line">            invocationHandler<span class="selector-class">.setRent</span>(host);</span><br><span class="line">            //这里的proxy就是动态生成的，我们并没有写</span><br><span class="line">            Rent proxy = (Rent) invocationHandler<span class="selector-class">.getProxy</span>();</span><br><span class="line">            proxy<span class="selector-class">.rent</span>();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><font style="color:#ff0000">测试结果</font></strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">中介看房</span><br><span class="line">房东要出租房子！</span><br><span class="line">买房</span><br></pre></td></tr></table></figure>



<h4 id="万能的调用处理程序"><a href="#万能的调用处理程序" class="headerlink" title="万能的调用处理程序"></a>万能的调用处理程序</h4><ul>
<li><strong><font style="color:#ff0000">万能的调用处理程序</font></strong></li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class ProxyInvocationHandler implements InvocationHandler &#123;</span><br><span class="line">      //被代理的接口————代理谁？</span><br><span class="line">      private <span class="selector-tag">Object</span> target;</span><br><span class="line">      public void setTarget(<span class="selector-tag">Object</span> target) &#123;</span><br><span class="line">            this<span class="selector-class">.target</span> = target;</span><br><span class="line">      &#125;</span><br><span class="line">      //生成得到代理类————生成代理类</span><br><span class="line">      public <span class="selector-tag">Object</span> getProxy()&#123;</span><br><span class="line">            return Proxy<span class="selector-class">.newProxyInstance</span>(this<span class="selector-class">.getClass</span>()<span class="selector-class">.getClassLoader</span>(),</span><br><span class="line">            	target<span class="selector-class">.getClass</span>()<span class="selector-class">.getInterfaces</span>(),this);</span><br><span class="line">      &#125;</span><br><span class="line">      //处理代理实例，并返回结果————调用代理类的执行方法</span><br><span class="line">      public <span class="selector-tag">Object</span> invoke(<span class="selector-tag">Object</span> proxy, Method method, <span class="selector-tag">Object</span><span class="selector-attr">[]</span> args) </span><br><span class="line">      	throws Throwable &#123;</span><br><span class="line">            log(method<span class="selector-class">.getName</span>());//利用反射机制获得方法的名字</span><br><span class="line">            <span class="selector-tag">Object</span> invoke = method<span class="selector-class">.invoke</span>(target, args);</span><br><span class="line">            return invoke;</span><br><span class="line">      &#125;</span><br><span class="line">      //日志</span><br><span class="line">      public void log(String msg)&#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;这是一个&quot;+msg+&quot;的方法&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong><font style="color:#ff0000">Client</font></strong></li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Client &#123;</span><br><span class="line">      public static void <span class="selector-tag">main</span>(String<span class="selector-attr">[]</span> args) &#123;</span><br><span class="line">            //真实角色</span><br><span class="line">            UserServiceImpl userService=new UserServiceImpl();</span><br><span class="line">            Host host = new Host();</span><br><span class="line"></span><br><span class="line">            //代理角色，不存在</span><br><span class="line">            ProxyInvocationHandler pin = new ProxyInvocationHandler();</span><br><span class="line"></span><br><span class="line">            //设置被代理的对象</span><br><span class="line">            pin<span class="selector-class">.setTarget</span>(userService);</span><br><span class="line">            <span class="comment">/*pin.setTarget(host);*/</span></span><br><span class="line"></span><br><span class="line">            //动态生成代理类</span><br><span class="line">            UserService proxy = (UserService) pin<span class="selector-class">.getProxy</span>();</span><br><span class="line">            proxy<span class="selector-class">.delete</span>();</span><br><span class="line">            <span class="comment">/*Rent proxy = (Rent) pin.getProxy();</span></span><br><span class="line"><span class="comment">            proxy.rent();*/</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="动态代理的好处"><a href="#动态代理的好处" class="headerlink" title="动态代理的好处"></a>动态代理的好处</h4><ul>
<li>可以使真实角色的操作更加纯粹！不用去关注一些公共的业务</li>
<li>公共也就交给代理角色！实现了业务的分工！</li>
<li>公共业务发生扩展的时候，方便集中管理！</li>
<li>一个动态代理类代理的是一个接口，一般就是对应的一类业务</li>
<li>一个动态代理类可以代理多个类，只要是实现了同一个接口即可！</li>
</ul>
<h2 id="9-AOP"><a href="#9-AOP" class="headerlink" title="9 AOP"></a>9 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/vfPKWYcUa4yjJ4cnmIEaxQ">AOP</a></h2><h3 id="9-1-什么是AOP"><a href="#9-1-什么是AOP" class="headerlink" title="9.1  什么是AOP"></a>9.1  <a target="_blank" rel="noopener" href="https://blog.csdn.net/q982151756/article/details/80513340">什么是AOP</a></h3><ul>
<li><p>AOP为<code>Aspect Oriented Programming</code>的缩写。</p>
<ul>
<li>对OOP( <code>Object Oriented Programming</code> ) 的补充和延伸，</li>
<li>==AOP 采用的是横向抽取机制==</li>
<li>==传统方法是纵向继承体系==</li>
</ul>
</li>
<li><p>AOP  的思想：使用业务与服务代码分离</p>
<ul>
<li>OOP 的思想：你做事，我放心</li>
</ul>
</li>
<li><p>AOP 的好处：不加代码加功能</p>
</li>
<li><p>==AOP 的底层原理是：动态代理==，</p>
<ul>
<li>==静态与动态代理的区别==：<ul>
<li>静态代理类是有程序员创建，在==运行前==，这些代理已经存在。</li>
<li>动态代理在==运行时==，运用反射的机制创建</li>
</ul>
</li>
</ul>
</li>
<li><p>AOP 操作的相关术语</p>
<ol>
<li>代理对象：需要增强的类</li>
</ol>
</li>
</ul>
<ol start="2">
<li>目标对象：增强后的代理类</li>
<li>连接点：可插入增强的方法</li>
<li>切点：插上了增强的方法</li>
<li>织入：把增强插入连接点的过程</li>
<li>增强（通知）advice：日志前，日志后，事务前，事务后</li>
<li>切面：事务，日志</li>
</ol>
<p>  <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1584329630217.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1584329630217</span></p>
<ul>
<li>xml 方式显示 aop（案例：对学生进行增删改查，顺便加上日志和事务）</li>
</ul>
<hr>
<ul>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/6016335">面向切面编程</a>，通过<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%A2%84%E7%BC%96%E8%AF%91/3191547">预编译</a>方式和运行期间动态代理实现程序功能的统一维护的一种技术。</li>
<li>AOP是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/OOP">OOP</a>的延续，是软件开发中的一个热点，也是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Spring">Spring</a>框架中的一个重要内容，是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/4035031">函数式编程</a>的一种衍生范型。</li>
<li>利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%80%A6%E5%90%88%E5%BA%A6/2603938">耦合度</a>降低，提高程序的可重用性，同时提高了开发的效率。  <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1595583263.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">https://blog.kuangstudy.com/usr/uploads/2019/10/1595583263.png</span> </li>
</ul>
<h3 id="9-2-AOP在Spring中的作用"><a href="#9-2-AOP在Spring中的作用" class="headerlink" title="9.2 AOP在Spring中的作用"></a>9.2 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33551891/article/details/89471984">AOP在Spring中的作用</a></h3><p>通过动态代理，可以在==指定位置执行对应==流程。这样就可以将一些横向的功能抽离出来形成一个独立的模块，然后在指定位置插入这些功能。这样的思想，被称为面向切面编程，亦即AOP。</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/03162109_vav0-1580365575323.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">3</span></p>
<p>为了在指定位置执行这些横向的功能，需要知道指定的是什么地方</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/03162132_tup3.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">4</span></p>
<h4 id="aop-aspect与aop-advisor的区别"><a href="#aop-aspect与aop-advisor的区别" class="headerlink" title="aop:aspect与aop:advisor的区别"></a>aop:aspect与aop:advisor的区别</h4><ul>
<li><p>&lt; aop:aspect&gt;：定义<strong>切面</strong>（切面包括通知和切点）</p>
</li>
<li><p>&lt; aop:advisor&gt;：定义<strong>通知器</strong>（通知器跟切面一样，也包括通知和切点）</p>
</li>
<li><p> &lt; aop:aspect&gt;定义切面时，只需要<strong>定义一般的bean</strong>就行</p>
</li>
<li><p>而定义&lt; aop:advisor&gt;中引用的通知时，<strong>通知必须实现Advice接口</strong>。</p>
</li>
</ul>
<h4 id="提供声明式事务；允许用户自定义切面"><a href="#提供声明式事务；允许用户自定义切面" class="headerlink" title="提供声明式事务；允许用户自定义切面"></a>提供声明式事务；允许用户自定义切面</h4><ul>
<li>横切关注点：跨越应用程序多个模块的==方法==或==功能==。即是，与我们业务逻辑无关的，但是我们需要关注的部分，就是横切关注点。如 <strong>日志 , 安全 , 缓存 , 事务</strong> 等等 ….</li>
<li>切面（Aspect）：横切关注点 被模块化 的特殊对象。即，它是一个==类==。</li>
<li>通知（Advice）：切面必须要完成的工作。即，它是类中的一个方法。</li>
<li>目标（Target）：被通知对象。 ——指真实角色Impl</li>
<li>代理（Proxy）：向目标对象应用==通知之后创建的对象==。</li>
<li>切入点（PointCut）：切面通知 执行的 “地点”的定义。</li>
<li>连接点（JointPoint）：与切入点匹配的执行点。</li>
</ul>
 <img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/142667477.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom:80%;"><span class="image-caption">https://blog.kuangstudy.com/usr/uploads/2019/10/142667477.png</span> 

<ul>
<li><strong><font style="color:#ff0000">SpringAOP中，通过Advice定义横切逻辑，Spring中支持5种类型的Advice:</font></strong></li>
</ul>
<p> <img   class="lazyload" data-original="https://blog.kuangstudy.com/usr/uploads/2019/10/904133406.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1570025522824.png</span> </p>
<p> <strong><font style="color:#ff0000">即 Aop 在 不改变原有代码的情况下 , 去增加新的功能 . </font></strong></p>
<h3 id="9-3-使用Spring实现AOP"><a href="#9-3-使用Spring实现AOP" class="headerlink" title="9.3 使用Spring实现AOP"></a>9.3 使用Spring实现AOP</h3><p><strong>（参考：6.4 AOP 注解）</strong></p>
<p>【重点】使用AOP织入，需要导入一个依赖包！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1584329739010.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 67%;float:left"><span class="image-caption">1584329739010</span>

<h4 id="方式一：使用原生spring-API接口【主要springAPI接口实现】："><a href="#方式一：使用原生spring-API接口【主要springAPI接口实现】：" class="headerlink" title="方式一：使用原生spring API接口【主要springAPI接口实现】："></a><font style="color:#ff0000">方式一：使用原生spring API接口【主要springAPI接口实现】：</font></h4><ul>
<li><font style="color:#ff0000"><strong>编写两个增强类 , 一个前置增强 一个后置增强</strong></font></li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class AfterLog implements AfterReturningAdvice &#123;</span><br><span class="line">      //returnValue：返回值</span><br><span class="line">      public void afterReturning(<span class="selector-tag">Object</span> returnValue, Method method, </span><br><span class="line">    	<span class="selector-tag">Object</span><span class="selector-attr">[]</span> args, <span class="selector-tag">Object</span> target) throws Throwable &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;目标对象：&quot;+target<span class="selector-class">.getClass</span>()<span class="selector-class">.getName</span>()<span class="selector-class">.toString</span>());</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;执行了&quot;+method<span class="selector-class">.getName</span>()+&quot;方法&quot;);</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;这是一个&quot;+args+&quot;参数&quot;);</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;返回结果：&quot;+returnValue);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class BeforeLog implements MethodBeforeAdvice &#123;</span><br><span class="line">      //method:要执行的目标对象的方法</span><br><span class="line">      //args：参数</span><br><span class="line">      //target：目标对象</span><br><span class="line">      public void <span class="built_in">before</span>(Method method, Object[] args,</span><br><span class="line">          Object target) throws Throwable &#123;</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;这是一个&quot;+target<span class="selector-class">.getClass</span>()<span class="selector-class">.getName</span>()<span class="selector-class">.toString</span>()</span><br><span class="line">              +&quot;目标对象的&quot;+method<span class="selector-class">.getName</span>()+&quot;被执行了&quot;);</span><br><span class="line">            System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;这是一个&quot;+args+&quot;参数&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><font style="color:#ff0000"> 去spring的文件中注册 , 并实现aop切入实现 , 注意导入约束 </font></strong></li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--注册bean--&gt;</span><br><span class="line">&lt;bean id=&quot;user&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.service</span><span class="selector-class">.UserServiceImpl</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;after&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.log</span><span class="selector-class">.AfterLog</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;before&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.log</span><span class="selector-class">.BeforeLog</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;rent&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.service</span><span class="selector-class">.Host</span>&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--方式一：使用原生spring API接口--&gt;</span><br><span class="line">&lt;!--配置AOP：需要导入aop的约束--&gt;</span><br><span class="line">&lt;aop:config&gt;</span><br><span class="line">    &lt;!--切入点：expression：表达式，execution</span><br><span class="line">    (要执行的位置：修饰词，返回值，类名，方法名，参数)</span><br><span class="line">    写个表达式定义到这里面--&gt;</span><br><span class="line">    &lt;aop:pointcut id=<span class="string">&quot;pointcut&quot;</span> expression=<span class="string">&quot;execution</span></span><br><span class="line"><span class="string">        (* com.yan.service.UserServiceImpl.delete(..))&quot;</span>/&gt;</span><br><span class="line">    &lt;aop:pointcut id=<span class="string">&quot;pointcut2&quot;</span> expression=<span class="string">&quot;execution</span></span><br><span class="line"><span class="string">        (* com.yan.service.Host.*(..))&quot;</span>/&gt;</span><br><span class="line">	&lt;!--通知--&gt;</span><br><span class="line">    &lt;aop:advisor advice-ref=<span class="string">&quot;before&quot;</span> pointcut-ref=<span class="string">&quot;pointcut&quot;</span>/&gt;</span><br><span class="line">    &lt;aop:advisor advice-ref=<span class="string">&quot;after&quot;</span> pointcut-ref=<span class="string">&quot;pointcut2&quot;</span>/&gt;</span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><font style="color:#ff0000"> 测试</font></strong></li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext=new ClassPathXmlApplicationContext(&quot;applicationContext<span class="selector-class">.xml</span>&quot;);</span><br><span class="line">//动态代理代理的是接口：注意点</span><br><span class="line">UserService user = applicationContext<span class="selector-class">.getBean</span>(&quot;user&quot;, UserService<span class="selector-class">.class</span>);</span><br><span class="line">user<span class="selector-class">.delete</span>();</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(&quot;===========================&quot;);</span><br><span class="line">Rent rent = applicationContext<span class="selector-class">.getBean</span>(&quot;rent&quot;, Rent<span class="selector-class">.class</span>);</span><br><span class="line">rent<span class="selector-class">.rent</span>();</span><br></pre></td></tr></table></figure>

<p>==<strong>Aop的重要性 : 很重要 . 一定要理解其中的思路 , 主要是思想的理解这一块 .</strong>==</p>
<p> <strong>Spring的Aop就是将公共的业务 (日志 , 安全等) 和领域业务结合起来 , 当执行领域业务时 , 将会把公共业务加进来 . 实现公共业务的重复利用 . 领域业务更纯粹 , 程序猿专注领域业务 ,==其本质还是动态代理==</strong></p>
<h4 id="Spring-execution表达式："><a href="#Spring-execution表达式：" class="headerlink" title="Spring execution表达式："></a>Spring execution表达式：</h4><p>（* com.sample.service.impl .. *。*（..））</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>执行（）</td>
<td>表达式的主体;</td>
</tr>
<tr>
<td>第一个” *“符号</td>
<td>表示返回值的类型任意;</td>
</tr>
<tr>
<td>com.sample.service.impl</td>
<td>AOP所切的服务的包名，即，我们的业务部分</td>
</tr>
<tr>
<td>包名后面的” ..“</td>
<td>表示当前包及子包</td>
</tr>
<tr>
<td>第二个” *“</td>
<td>表示类名，*即所有类。此处可以自定义，下文有举例</td>
</tr>
<tr>
<td>。*（..）</td>
<td>表示任何方法名，括号表示参数，两个点表示任何参数类型</td>
</tr>
</tbody></table>
<h4 id="方式二：-自定义类来实现Aop-【主要是切面定义】："><a href="#方式二：-自定义类来实现Aop-【主要是切面定义】：" class="headerlink" title="方式二： 自定义类来实现Aop 【主要是切面定义】："></a><font style="color:#ff0000"><strong>方式二： 自定义类来实现Aop 【主要是切面定义】：</strong></font></h4><p>目标业务类不变依旧是userServiceImpl</p>
<p><strong><font style="color:#ff0000"> 第一步 : 写我们自己的一个切入类</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiyPointcut</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---------方法执行前---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---------方法执行后---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><font style="color:#ff0000"> 去spring中配置</font></strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.service.UserServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;diy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.diy.DiyPointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--第二种方式自定义实现--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义切面，ref 要引用的类--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;diy&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--切入点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution</span></span></span><br><span class="line"><span class="string"><span class="tag">        (* com.yan.service.UserServiceImpl.* (..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--通知--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;after&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><font style="color:#ff0000"> 测试：</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="方式三：使用注解实现"><a href="#方式三：使用注解实现" class="headerlink" title="方式三：使用注解实现"></a>方式三：使用注解实现</h4><p>  <strong><font style="color:#ff0000">第一步：编写一个注解实现的增强类 </font></strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.ProceedingJoinPoint</span>;</span><br><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.Signature</span>;</span><br><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.annotation</span><span class="selector-class">.After</span>;</span><br><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.annotation</span><span class="selector-class">.Around</span>;</span><br><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.annotation</span><span class="selector-class">.Aspect</span>;</span><br><span class="line">import org<span class="selector-class">.aspectj</span><span class="selector-class">.lang</span><span class="selector-class">.annotation</span><span class="selector-class">.Before</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@Aspect</span>//标注这个类是一个切面</span><br><span class="line">public class AnnotationPointCut &#123;</span><br><span class="line">      <span class="keyword">@Before</span>(&quot;execution(* com.yan.service.UserServiceImpl.*(..))<span class="string">&quot;)</span></span><br><span class="line"><span class="string">      public void before()&#123;</span></span><br><span class="line"><span class="string">            System.out.println(&quot;</span>执行之前<span class="string">&quot;);</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">      @After(&quot;</span>execution(* com.yan.service.UserServiceImpl.*(..))<span class="string">&quot;)</span></span><br><span class="line"><span class="string">      public void after()&#123;</span></span><br><span class="line"><span class="string">            System.out.println(&quot;</span>执行之后<span class="string">&quot;);</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">      //在环绕增强中，我们可以给定一个参数，代表我们要获取处理切入的点</span></span><br><span class="line"><span class="string">      @Around(&quot;</span>execution(* com.yan.service.UserServiceImpl.*(..))<span class="string">&quot;)</span></span><br><span class="line"><span class="string">      public void around(ProceedingJoinPoint pj) throws Throwable &#123;</span></span><br><span class="line"><span class="string">            System.out.println(&quot;</span>环绕之前<span class="string">&quot;);</span></span><br><span class="line"><span class="string">            Signature signature = pj.getSignature();//获得签名</span></span><br><span class="line"><span class="string">            System.out.println(&quot;</span>signature<span class="string">&quot;+signature);</span></span><br><span class="line"><span class="string">            pj.proceed();//让目标方法执行</span></span><br><span class="line"><span class="string">            System.out.println(&quot;</span>环绕之后<span class="string">&quot;);</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p> <strong>java spring 环绕通知 ProceedingJoinPoint 执行proceed方法的作用是什么 ?</strong></p>
<ul>
<li><p> 环绕通知 ProceedingJoinPoint 执行proceed方法的作用是<strong>让目标方法执行</strong>，这也是环绕通知和前置、后置通知方法的一个最大区别。</p>
</li>
<li><p>简单理解，环绕通知=前置+目标方法执行+后置通知，<strong>proceed方法就是用于启动目标方法执行的.</strong></p>
</li>
</ul>
<p><strong><font style="color:#ff0000">第二步：在Spring配置文件中，注册bean，并增加支持注解的配置 </font></strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--注册bean--&gt;</span><br><span class="line">&lt;bean id=&quot;user&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.service</span><span class="selector-class">.UserServiceImpl</span>&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;anno&quot; class=&quot;com<span class="selector-class">.yan</span><span class="selector-class">.Annotation</span><span class="selector-class">.AnnotationPointCut</span>&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--开启注解支持！--&gt;</span><br><span class="line">&lt;aop:aspectj-autoproxy/&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>通过aop命名空间的&lt;aop:aspectj-autoproxy /&gt;声明自动为spring容器中那些配置@aspectJ切面的bean创建代理，织入切面。当然，spring 在内部依旧采用AnnotationAwareAspectJAutoProxyCreator进行自动代理的创建工作，但具体实现的细节已经被&lt;aop:aspectj-autoproxy /&gt;隐藏起来了 </p>
</li>
<li><p>&lt;aop:aspectj-autoproxy  poxy-target-class=”false”/&gt;</p>
<ul>
<li>有一个proxy-target-class属性，默认为false，表示使用jdk动态代理织入增强，</li>
<li>当proxy-target-class属性为true时，表示使用CGLib动态代理技术织入增强。</li>
<li>不过即使proxy-target-class设置为false，如果目标类没有声明接口，则spring将自动使用CGLib动态代理</li>
</ul>
</li>
</ul>
<p><strong><font style="color:#ff0000">测试结果：</font></strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">环绕之前</span><br><span class="line">signaturevoid com<span class="selector-class">.yan</span><span class="selector-class">.service</span><span class="selector-class">.UserService</span><span class="selector-class">.delete</span>()</span><br><span class="line">执行之前</span><br><span class="line">删除一个账号</span><br><span class="line">环绕之后</span><br><span class="line">执行之后</span><br></pre></td></tr></table></figure>



<h2 id="10-Spring：整合MyBatis"><a href="#10-Spring：整合MyBatis" class="headerlink" title="10 Spring：整合MyBatis"></a>10 Spring：整合MyBatis</h2><ol>
<li><p>导入相关jar包</p>
<ol>
<li><p>junit</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>mybatis</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>mysql-connector-java</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>spring相关</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>aspectJ AOP 织入器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>mybatis-spring整合包 【重点】</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>配置Maven静态资源过滤问题！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>编写配置文件</p>
</li>
<li><p>代码实现</p>
</li>
</ol>
<h3 id="10-1-回忆MyBatis"><a href="#10-1-回忆MyBatis" class="headerlink" title="10.1 回忆MyBatis"></a>10.1 回忆MyBatis</h3><p><strong>编写pojo实体类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;  <span class="comment">//id</span></span><br><span class="line">    <span class="keyword">private</span> String name;   <span class="comment">//姓名</span></span><br><span class="line">    <span class="keyword">private</span> String pwd;   <span class="comment">//密码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>实现mybatis的配置文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.kuang.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.kuang.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>UserDao接口编写</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接口对应的Mapper映射文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">      select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>测试类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectUser</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(resource);</span><br><span class="line">    <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(inputStream);</span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; userList = mapper.selectUser();</span><br><span class="line">    <span class="keyword">for</span> (User user: userList)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-2-MyBatis-Spring学习"><a href="#10-2-MyBatis-Spring学习" class="headerlink" title="10.2 MyBatis-Spring学习"></a>10.2 MyBatis-Spring学习</h3><p>引入Spring之前需要了解mybatis-spring包中的一些重要类；</p>
<p><a target="_blank" rel="noopener" href="http://www.mybatis.org/spring/zh/index.html">http://www.mybatis.org/spring/zh/index.html</a></p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/2528361494.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1570028694289.png</span></p>
<p><strong>什么是 MyBatis-Spring？</strong></p>
<p>MyBatis-Spring 会帮助你将 MyBatis 代码无缝地整合到 Spring 中。</p>
<p><strong>知识基础</strong></p>
<p>在开始使用 MyBatis-Spring 之前，你需要先熟悉 Spring 和 MyBatis 这两个框架和有关它们的术语。这很重要</p>
<p>MyBatis-Spring 需要以下版本：</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/4294605569.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">QQ截图20191021223404.jpg</span></p>
<p>如果使用 Maven 作为构建工具，仅需要在 pom.xml 中加入以下代码即可：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>要和 Spring 一起使用 MyBatis，需要在 Spring 应用上下文中定义至少两样东西：一个 <code>SqlSessionFactory</code> 和至少一个数据映射器类。</p>
<p>在 MyBatis-Spring 中，可使用 <code>SqlSessionFactoryBean</code>来创建 <code>SqlSessionFactory</code>。 要配置这个工厂 bean，只需要把下面代码放在 Spring 的 XML 配置文件中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：<code>SqlSessionFactory</code> 需要一个 <code>DataSource</code>（数据源）。 这可以是任意的 <code>DataSource</code>，只需要和配置其它 Spring 数据库连接一样配置它就可以了。</p>
<p>在基础的 MyBatis 用法中，是通过 <code>SqlSessionFactoryBuilder</code> 来创建 <code>SqlSessionFactory</code> 的。 而在 MyBatis-Spring 中，则使用 <code>SqlSessionFactoryBean</code> 来创建。</p>
<p>在 MyBatis 中，你可以使用 <code>SqlSessionFactory</code> 来创建 <code>SqlSession</code>。一旦你获得一个 session 之后，你可以使用它来执行映射了的语句，提交或回滚连接，最后，当不再需要它的时候，你可以关闭 session。</p>
<p><code>SqlSessionFactory</code> 有一个唯一的必要属性：用于 JDBC 的 <code>DataSource</code>。这可以是任意的 <code>DataSource</code> 对象，它的配置方法和其它 Spring 数据库连接是一样的。</p>
<p>一个常用的属性是 <code>configLocation</code>，它用来指定 MyBatis 的 XML 配置文件路径。它在需要修改 MyBatis 的基础配置非常有用。通常，基础配置指的是 <code>或</code> 元素。</p>
<p>需要注意的是，这个配置文件<strong>并不需要</strong>是一个完整的 MyBatis 配置。确切地说，任何环境配置（<code>），数据源（</code>）和 MyBatis 的事务管理器（``）都会被<strong>忽略</strong>。<code>SqlSessionFactoryBean</code> 会创建它自有的 MyBatis 环境配置（<code>Environment</code>），并按要求设置自定义环境的值。</p>
<p><code>SqlSessionTemplate</code> 是 MyBatis-Spring 的核心。作为 <code>SqlSession</code> 的一个实现，这意味着可以使用它无缝代替你代码中已经在使用的 <code>SqlSession</code>。</p>
<p>模板可以参与到 Spring 的事务管理中，并且由于其是线程安全的，可以供多个映射器类使用，你应该<strong>总是</strong>用 <code>SqlSessionTemplate</code> 来替换 MyBatis 默认的 <code>DefaultSqlSession</code> 实现。在同一应用程序中的不同类之间混杂使用可能会引起数据一致性的问题。</p>
<p>可以使用 <code>SqlSessionFactory</code> 作为构造方法的参数来创建 <code>SqlSessionTemplate</code> 对象。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>现在，这个 bean 就可以直接注入到你的 DAO bean 中了。你需要在你的 bean 中添加一个 SqlSession 属性，就像下面这样：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> SqlSession sqlSession;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSqlSession</span><span class="params">(SqlSession sqlSession)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sqlSession = sqlSession;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sqlSession.getMapper...;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>按下面这样，注入 <code>SqlSessionTemplate</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.sample.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSession&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="10-3-整合实现一"><a href="#10-3-整合实现一" class="headerlink" title="10.3 整合实现一"></a>10.3 整合实现一</h3><ol>
<li><p>引入Spring配置文件beans.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>配置数据源替换mybaits的数据源：在这里使用spring提供的jdbc</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置数据源：数据源有非常多，可以使用第三方的，也可使使用Spring的--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=</span></span><br><span class="line"><span class="tag">      <span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="string"><span class="tag">       useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;y18738037378&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>配置SqlSessionFactory，关联MyBatis</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--原来的工具类--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--String resource=&quot;mybatis-config.xml&quot;;</span></span><br><span class="line"><span class="comment">InputStream resourceAsStream = Resources.getResourceAsStream(resource);</span></span><br><span class="line"><span class="comment">SqlSessionFactory build = new 		SqlSessionFactoryBuilder().build(resourceAsStream);</span></span><br><span class="line"><span class="comment">SqlSession sqlSession = build.openSession(true);--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置SqlSessionFactory：SqlSessionFactoryBean来创建SqlSessionFactory--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--关联mybatis配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/yan/dao/*.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="mybatis-整合spring是否需要配mapperLocations？"><a href="#mybatis-整合spring是否需要配mapperLocations？" class="headerlink" title="mybatis 整合spring是否需要配mapperLocations？"></a>mybatis 整合spring是否需要配mapperLocations？</h4><ol>
<li>当mybatis的xml文件和mapper接口<strong>不在相同包</strong>下时，需要用mapperLocations属性指定xml文件的路径</li>
<li>*是个通配符，代表所有的文件，**代表所有目录下</li>
<li> 如果Mapper.xml与Mapper.class在<strong>同一个包下且同名</strong>，spring扫描Mapper.class的同时会<strong>自动扫描</strong>同名的Mapper.xml<strong>并装配</strong>到Mapper.class </li>
<li>在<strong>没有注册mapper映射文件</strong>的情况下，如果Mapper.xml与Mapper.class不在同一个包下或者不同名，就必须使用配置mapperLocations指定mapper.xml的位置。此时spring是通过识别mapper.xml中的 <mapper namespace="com.fan.mapper.UserDao"> namespace的值来确定对应的Mapper.class的。</mapper></li>
</ol>
</li>
<li><p>注册sqlSessionTemplate，关联sqlSessionFactory；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册sqlSessionTemplate , 关联sqlSessionFactory--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--只能使用构造器注入SqlSessionFactory，因为没有set方法--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>增加Dao接口的实现类；私有化sqlSessionTemplate</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sqlSession不用我们自己创建了，Spring来管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"><span class="comment">/*在原来，我们的所有操作，从工具类获得sqlsession来执行，现在都使用SqlSessionTemplate*/</span></span><br><span class="line"><span class="comment">/*UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span></span><br><span class="line"><span class="comment">List&lt;User&gt; users = mapper.selectAll();*/</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">private</span> SqlSessionTemplate sqlSession;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSqlSession</span><span class="params">(SqlSessionTemplate sqlSession)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.sqlSession = sqlSession;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectAll</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">            <span class="keyword">return</span> mapper.selectAll();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong><font style="color:#ff0000">为什么要从创建这个类？</font></strong><ul>
<li>spring要管理对象，所以自动创建对象，而mybatis无法创建对象，</li>
</ul>
</li>
<li><strong><font style="color:#ff0000">要怎么创建哪？</font></strong><ul>
<li>手动写一个UserMapperImpl类，而setSqlSession方法用来做原来mybatis要做的事情变成业务</li>
<li><strong>SqlSessionTemplate就是MyBatis-Spring的核心</strong></li>
</ul>
</li>
</ul>
</li>
<li><p>注册bean实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;UserMapperImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.yan.dao.UserMapperImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSession&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;SqlSession&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext=</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="type">UserMapper</span> <span class="variable">userMapperImpl</span> <span class="operator">=</span> applicationContext.</span><br><span class="line">    getBean(<span class="string">&quot;UserMapperImpl&quot;</span>, UserMapper.class);</span><br><span class="line">List&lt;User&gt; users = userMapperImpl.selectAll();</span><br><span class="line">System.out.println(users);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>结果成功输出！现在我们的Mybatis配置文件的状态！发现都可以被Spring整合！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.kuang.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="10-4-整合实现二"><a href="#10-4-整合实现二" class="headerlink" title="10.4 整合实现二"></a>10.4 整合实现二</h3><p>mybatis-spring1.2.3版以上的才有这个 . </p>
<p>官方文档截图 : </p>
<p>dao继承Support类 , <strong>直接</strong>利用 getSqlSession() <strong>获得SqlSession</strong>, 然后直接注入SqlSessionFactory . 比起方式1 , 不需要管理SqlSessionTemplate , 而且对事务的支持更加友好 . 可跟踪源码查看</p>
<p><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/3935980021.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">1570030073773.png</span></p>
<p>测试：</p>
<ol>
<li><p>将我们上面写的UserDaoImpl修改一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>修改bean的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--不需要：</span></span><br><span class="line"><span class="comment">&lt;bean id=&quot;SqlSession&quot; class=&quot;org.mybatis.spring.SqlSessionTemplate&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;constructor-arg index=&quot;0&quot; ref=&quot;sqlSessionFactory&quot;/&gt;</span></span><br><span class="line"><span class="comment">&lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.kuang.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">    List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>总结 : 整合到spring中以后可以完全不要mybatis的配置文件，除了这些方式可以实现整合之外，我们还可以使用注解来实现，这个等我们后面学习SpringBoot的时候还会测试整合！</p>
<p>​    </p>
<h2 id="11-声明式事务"><a href="#11-声明式事务" class="headerlink" title="11 声明式事务"></a>11 声明式事务</h2><h3 id="11-1-回顾事务"><a href="#11-1-回顾事务" class="headerlink" title="11.1 回顾事务"></a>11.1 回顾事务</h3><ul>
<li>事务在项目开发过程非常重要，涉及到数据的一致性的问题，不容马虎！</li>
<li>事务管理是企业级应用程序开发中必备技术，用来确保数据的完整性和一致性。</li>
<li><strong><font style="color:#ff0000">事务就是把一系列的动作当成一个独立的工作单元，这些动作要么全部完成，要么全部不起作用。</font></strong></li>
</ul>
<h4 id="事务四个属性ACID"><a href="#事务四个属性ACID" class="headerlink" title="事务四个属性ACID"></a><strong>事务四个属性ACID</strong></h4><ol>
<li><strong><font style="color:#ff0000">原子性（atomicity）</font></strong><ul>
<li>事务是原子性操作，由一系列动作组成，事务的原子性确保动作要么全部完成，要么完全不起作用</li>
</ul>
</li>
<li><strong><font style="color:#ff0000">一致性（consistency）</font></strong><ul>
<li>一旦所有事务动作完成，事务就要被提交。数据和资源处于一种满足业务规则的一致性状态中</li>
</ul>
</li>
<li><strong><font style="color:#ff0000">隔离性（isolation）</font></strong><ul>
<li>可能多个事务会同时处理相同的数据，因此每个事务都应该与其他事务隔离开来，防止数据损坏</li>
</ul>
</li>
<li><strong><font style="color:#ff0000">持久性（durability）</font></strong><ul>
<li>事务一旦完成，无论系统发生什么错误，结果都不会受到影响。通常情况下，事务的结果被写到持久化存储器中</li>
</ul>
</li>
</ol>
<h4 id="使用MyBatis-Spring的主要原因"><a href="#使用MyBatis-Spring的主要原因" class="headerlink" title="使用MyBatis-Spring的主要原因"></a><strong>使用MyBatis-Spring的主要原因</strong></h4><ul>
<li>是它允许MyBatis参与到Spring的事务管理中，而不是给MyBatis创建一个新的事务管理器。</li>
</ul>
<h3 id="11-2-测试"><a href="#11-2-测试" class="headerlink" title="11.2 测试"></a>11.2 测试</h3><p>将上面的代码拷贝到一个新项目中</p>
<p>在之前的案例中，我们给userDao接口新增两个方法，删除和增加用户；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加一个用户</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">addUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//根据id删除用户</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">deleteUser</span><span class="params">(<span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure>

<p>mapper文件，我们故意把 deletes 写错，测试！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span></span><br><span class="line"> insert into user (id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;)</span><br><span class="line"> <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line"> deletes from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>编写接口的实现类，在实现类中，我们去操作一波</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//增加一些操作</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">4</span>,<span class="string">&quot;小明&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">        mapper.addUser(user);</span><br><span class="line">        mapper.deleteUser(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新增</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteUser</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getSqlSession().getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.deleteUser(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">    List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>报错：sql异常，delete写错了</p>
<p>结果 ：插入成功！</p>
<p>没有进行事务的管理；我们想让他们都成功才成功，有一个失败，就都失败，我们就应该需要<strong>事务！</strong></p>
<p>以前我们都需要自己手动管理事务，十分麻烦！</p>
<p>但是Spring给我们提供了事务管理，我们只需要配置即可；</p>
<h3 id="11-3-Spring中的事务管理"><a href="#11-3-Spring中的事务管理" class="headerlink" title="11.3 Spring中的事务管理"></a>11.3 Spring中的事务管理</h3><p>Spring在不同的事务管理API之上定义了一个抽象层，使得开发人员不必了解底层的事务管理API就可以使用Spring的事务管理机制。Spring支持编程式事务管理和声明式的事务管理。</p>
<p><strong>编程式事务管理</strong></p>
<ul>
<li>将事务管理代码<strong>嵌到</strong>业务方法中来控制事务的提交和回滚</li>
<li>缺点：必须在每个事务操作业务逻辑中包含额外的事务管理代码</li>
</ul>
<p><strong>声明式事务管理</strong></p>
<ul>
<li>一般情况下比编程式事务好用。</li>
<li>将事务管理代码从业务方法中<strong>分离</strong>出来，以声明的方式来实现事务管理。</li>
<li>将事务管理作为<strong>横切关注点</strong>，通过aop方法模块化。Spring中通过Spring AOP框架支持声明式事务管理。</li>
</ul>
<p><strong>使用Spring管理事务，注意头文件的约束导入 : tx</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line"></span><br><span class="line">http://www.springframework.org/schema/tx</span><br><span class="line">http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>事务管理器</strong></p>
<ul>
<li>无论使用Spring的哪种事务管理策略（编程式或者声明式）事务管理器都是必须的。</li>
<li>就是 Spring的核心事务管理抽象，管理封装了一组独立于技术的方法。</li>
</ul>
<p><strong>JDBC事务</strong></p>
<ul>
<li><strong>配置声明式事务</strong></li>
<li><strong>开启spring的事务处理功能</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>配置好事务管理器后我们需要去配置事务的通知</strong></p>
<ul>
<li><strong>结合AOP实现事务的织入</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置事务通知--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置哪些方法使用什么样的事务,配置事务的传播特性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;search*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="spring事务传播特性："><a href="#spring事务传播特性：" class="headerlink" title="spring事务传播特性："></a><strong>spring事务传播特性：</strong></h4><p>事务传播行为就是多个事务方法相互调用时，<strong>事务如何在这些方法间传播</strong>。spring支持7种事务传播行为：</p>
<ul>
<li>propagation_requierd：如果当前没有事务，就新建一个事务，如果已存在一个事务中，加入到这个事务中，这是最常见的选择。</li>
<li>propagation_supports：支持当前事务，如果没有当前事务，就以非事务方法执行。</li>
<li>propagation_mandatory：使用当前事务，如果没有当前事务，就抛出异常。</li>
<li>propagation_required_new：新建事务，如果当前存在事务，把当前事务挂起。</li>
<li>propagation_not_supported：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起。</li>
<li>propagation_never：以非事务方式执行操作，如果当前事务存在则抛出异常。</li>
<li>propagation_nested：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与propagation_required类似的操作</li>
</ul>
<p>Spring 默认的事务传播行为是 PROPAGATION_REQUIRED，它适合于绝大多数的情况。</p>
<p>假设 ServiveX#methodX() 都工作在事务环境下（即都被 Spring  事务增强了），假设程序中存在如下的调用链：Service1#method1()-&gt;Service2#method2()-&gt;Service3#method3()，那么这 3 个服务类的 3 个方法通过 Spring 的事务传播机制都工作在同一个事务中。</p>
<p>就好比，我们刚才的几个方法存在调用，所以会被放在一组事务当中！</p>
<p><strong>配置AOP</strong></p>
<p>导入aop的头文件！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置aop织入事务--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;txPointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.kuang.dao.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;txPointcut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>进行测试</strong></p>
<p>删掉刚才插入的数据，再次测试！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> (UserMapper) context.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">    List&lt;User&gt; user = mapper.selectUser();</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-4-思考问题？"><a href="#11-4-思考问题？" class="headerlink" title="11.4 思考问题？"></a>11.4 思考问题？</h3><p>为什么需要配置事务？</p>
<ul>
<li>如果不配置，可能存在数据提交不一致的情况下；</li>
<li>如果我们不在spring中去配置声明式事务，我们就需要在代码中手动配置事务；</li>
<li>事务在项目开发过程非常重要，涉及到数据的一致性的问题，不容马虎！</li>
</ul>
<h2 id="12-JdbcTemplate"><a href="#12-JdbcTemplate" class="headerlink" title="12 JdbcTemplate"></a>12 JdbcTemplate</h2><h3 id="1-JdbcTemplate-介绍"><a href="#1-JdbcTemplate-介绍" class="headerlink" title="1 JdbcTemplate 介绍"></a>1 JdbcTemplate 介绍</h3><ul>
<li><p><strong>持久层：是springmvc本身就有的，但是使用mybatis持久层</strong></p>
</li>
<li><p><strong>spring是-一个站式框架，它对javaee每层都有解决技术</strong> </p>
</li>
<li><p><strong>对持久化技术的支持</strong> </p>
<table>
<thead>
<tr>
<th>Orm持久技术</th>
<th>模板类</th>
</tr>
</thead>
<tbody><tr>
<td>jdbc</td>
<td>org.springframework.jdbc.core.JdbcTemplate</td>
</tr>
<tr>
<td>Hibernate3.x<br>Hibernate4.x</td>
<td>org.springframework.orm.hibernate3.HibernateTemplate<br>org.springframework.orm.hibernate4.Hibernate Template</td>
</tr>
<tr>
<td>mybatis</td>
<td>org.mybatis.spring.SqlSessionTemplate implements</td>
</tr>
</tbody></table>
</li>
<li><p><strong>jdbcTemplate是 对jdbc进行了封装</strong> </p>
</li>
</ul>
<h3 id="2-JdbcTemplate-使用"><a href="#2-JdbcTemplate-使用" class="headerlink" title="2 JdbcTemplate 使用"></a>2 JdbcTemplate 使用</h3><img   class="lazyload" data-original="/2022/03/10/Spring%E7%AC%94%E8%AE%B0/1584927509232.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  style="zoom: 80%;float:left"><span class="image-caption">1584927509232</span>

<h4 id="（测试中使用）增"><a href="#（测试中使用）增" class="headerlink" title="==（测试中使用）增=="></a>==（测试中使用）增==</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Emp</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> empno;</span><br><span class="line">	<span class="keyword">private</span> String ename;</span><br><span class="line">	<span class="keyword">private</span> String job;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> mgr;</span><br><span class="line">	<span class="keyword">private</span> Date hiredate;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">double</span> sal;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">double</span> comm;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> deptno;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建数据源</span></span><br><span class="line">DriverManagerDataSource dataSource=<span class="keyword">new</span> <span class="title class_">DriverManagerDataSource</span>();</span><br><span class="line">dataSource.setDriverClassName(<span class="string">&quot;oracle.jdbc.OracleDriver&quot;</span>);</span><br><span class="line">dataSource.setUrl(<span class="string">&quot;jdbc:oracle:thin:@localhost:1521:orac&quot;</span>);</span><br><span class="line">dataSource.setUsername(<span class="string">&quot;scott&quot;</span>);</span><br><span class="line">dataSource.setPassword(<span class="string">&quot;scott&quot;</span>);</span><br><span class="line">System.out.println(dataSource);</span><br><span class="line"><span class="comment">//创建jdbc模板</span></span><br><span class="line"><span class="type">JdbcTemplate</span> <span class="variable">template</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>(dataSource);</span><br><span class="line"><span class="comment">//创建sql</span></span><br><span class="line">String sqlString=<span class="string">&quot;insert into emp values (?,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line"><span class="comment">//调用jdbcTemplate的方法</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> template.update(sqlString, <span class="number">8888</span>,<span class="string">&quot;华&quot;</span>,<span class="string">&quot;学生&quot;</span>,<span class="number">7788</span>,<span class="keyword">new</span> <span class="title class_">Date</span>(),<span class="number">1000</span>,<span class="number">5</span>,<span class="number">40</span>);</span><br><span class="line">System.out.println(i);</span><br></pre></td></tr></table></figure>

<h4 id="（开发中使用）CURD"><a href="#（开发中使用）CURD" class="headerlink" title="==（开发中使用）CURD=="></a>==（开发中使用）CURD==</h4><h5 id="1-Dao层-1"><a href="#1-Dao层-1" class="headerlink" title="1 Dao层"></a>1 Dao层</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span>;</span><br><span class="line">publi[c <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Emp emp)</span>;</span><br><span class="line"><span class="keyword">public</span> Emp <span class="title function_">getEmpByEmpno</span><span class="params">(Integer empno)</span>;</span><br><span class="line"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">getEmps</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    <span class="comment">//给实现注入template</span></span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate template;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTemplate</span><span class="params">(JdbcTemplate template)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.template = template;</span><br><span class="line">	&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">	<span class="comment">//添加一个员工</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		String sql=<span class="string">&quot;insert into emp values (?,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">		<span class="comment">//返回的值是受影响的行数</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> template.update(sql,                                						emp.getEmpno(),emp.getEname(),emp.getJob(),emp.getMgr(),                                emp.getHiredate(),emp.getSal(),emp.getComm(),emp.getDeptno());</span><br><span class="line">		System.out.println(i);</span><br><span class="line">	&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">	<span class="comment">//删除员工</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> template.update(<span class="string">&quot;delete from emp where empno=?&quot;</span>,emp.getEmpno());</span><br><span class="line">		System.out.println(i);</span><br><span class="line">	&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">	<span class="comment">//更新员工信息</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> template.update(<span class="string">&quot;update emp set 							ename=?,job=?,mgr=?,hiredate=?,sal=?,comm=?,deptno=? where empno=?&quot;</span>,                emp.getEname(),emp.getJob(),emp.getMgr(),emp.getHiredate(),emp.getSal(),emp.getComm(),emp.getDeptno(),emp.getEmpno());</span><br><span class="line">		System.out.println(i);</span><br><span class="line">	&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">	<span class="comment">//根据员工号获得员工信息</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Emp <span class="title function_">getEmpByEmpno</span><span class="params">(Integer empno)</span> &#123;</span><br><span class="line">    <span class="comment">//sping中的RowMapper可以将数据中的每一行数据封装成用户定义的类。</span></span><br><span class="line">    <span class="comment">//BeanPropertyRowMapper是用来映射Java对象的属性和MySQL表的字段名称的。但是，在映射的过程中，如果不注意Java对象的属性名的规范，很可能就得不到我们想要的结果。</span></span><br><span class="line">		RowMapper&lt;Emp&gt; rowMapper=<span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;Emp&gt;(Emp.class);</span><br><span class="line">		<span class="keyword">return</span> template.queryForObject(<span class="string">&quot;select * from emp where empno=?&quot;</span>, </span><br><span class="line">                                       rowMapper, empno);</span><br><span class="line">	&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">	<span class="comment">//获得所有员工信息</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">getEmps</span><span class="params">()</span> &#123;</span><br><span class="line">		RowMapper&lt;Emp&gt; rowMapper=<span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;Emp&gt;(Emp.class);</span><br><span class="line">		<span class="keyword">return</span> template.query(<span class="string">&quot;select * from emp&quot;</span>, rowMapper);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-model层"><a href="#2-model层" class="headerlink" title="==2 model层=="></a>==2 model层==</h5><p>(在查询的时候有未赋值的，基本数据类型无法分辨，包装类型可以分辨未赋值与0的区别)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Emp</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Integer empno;</span><br><span class="line">	<span class="keyword">private</span> String ename;</span><br><span class="line">	<span class="keyword">private</span> String job;</span><br><span class="line">	<span class="keyword">private</span> Integer mgr;</span><br><span class="line">	<span class="keyword">private</span> Date hiredate;</span><br><span class="line">	<span class="keyword">private</span> Double sal;</span><br><span class="line">	<span class="keyword">private</span> Double comm;</span><br><span class="line">	<span class="keyword">private</span> Integer deptno;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-测试"><a href="#3-测试" class="headerlink" title="3 测试"></a>3 测试</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext context=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span></span><br><span class="line">    (<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="type">EmpDao</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(EmpDao.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Emp emp = new Emp(9998, &quot;abc&quot;, &quot;CLERK&quot;, 7698, new Date(), 10000.0, 500.0, 30);</span></span><br><span class="line"><span class="comment">bean.add(emp);</span></span><br><span class="line"><span class="comment">emp.setEname(&quot;qwe&quot;);</span></span><br><span class="line"><span class="comment">emp.setJob(&quot;teacher&quot;);</span></span><br><span class="line"><span class="comment">bean.update(emp);</span></span><br><span class="line"><span class="comment">bean.del(new Emp(9998));*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">Emp</span> <span class="variable">empByEmpno</span> <span class="operator">=</span> bean.getEmpByEmpno(<span class="number">1000</span>);</span><br><span class="line">System.out.println(empByEmpno);</span><br><span class="line">System.out.println(<span class="string">&quot;==========================&quot;</span>);</span><br><span class="line">List&lt;Emp&gt; emps = bean.getEmps();</span><br><span class="line"><span class="keyword">for</span> (Emp emp : emps) &#123;</span><br><span class="line">    System.out.println(emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4-特别案例-Dao层"><a href="#4-特别案例-Dao层" class="headerlink" title="==4 特别案例:Dao层=="></a>==4 特别案例:Dao层==</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	查单个值</span></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">getEmpCount</span><span class="params">()</span>;</span><br><span class="line"><span class="comment">//	根据员工名称查询员工部门名称</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getDnameByename</span><span class="params">(String ename)</span>;</span><br><span class="line"><span class="comment">//	回调</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getEname</span><span class="params">(<span class="keyword">final</span> <span class="type">int</span> empno)</span>;</span><br><span class="line"><span class="comment">//	增多个对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(List&lt;Emp&gt; emps)</span>;</span><br></pre></td></tr></table></figure>

<h5 id="5-创建过程"><a href="#5-创建过程" class="headerlink" title="==5 创建过程=="></a>==5 创建过程==</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create or replace procedure pro_getEname(v_empno emp.empno%type,v_ename out emp.ename%type)</span><br><span class="line">as</span><br><span class="line">begin</span><br><span class="line">select ename into v_ename from emp where empno=v_empno;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure>

<h5 id="6-实现层"><a href="#6-实现层" class="headerlink" title="==6 实现层=="></a>==6 实现层==</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">getEmpCount</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> template.queryForObject(<span class="string">&quot;select count(*) from emp&quot;</span>, Integer.class);</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getDnameByename</span><span class="params">(String ename)</span> &#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queryForObject</span> <span class="operator">=</span> template.queryForObject(<span class="string">&quot;select dname from emp e join dept d on (e.deptno=d.deptno) where ename=?&quot;</span>, String.class, ename);</span><br><span class="line">    <span class="keyword">return</span> queryForObject;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getEname</span><span class="params">(<span class="keyword">final</span> <span class="type">int</span> empno)</span> &#123;</span><br><span class="line">    <span class="comment">//调用存储过程：template.execute(csc,action);</span></span><br><span class="line">    <span class="comment">//CallableStatementCreator csc, CallableStatementCallback action</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">execute</span> <span class="operator">=</span> template.execute(<span class="keyword">new</span> <span class="title class_">CallableStatementCreator</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> CallableStatement <span class="title function_">createCallableStatement</span><span class="params">(Connection connection)</span></span><br><span class="line">                <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">            <span class="comment">// 调用的sql   </span></span><br><span class="line">            <span class="type">CallableStatement</span> <span class="variable">prepareCall</span> <span class="operator">=</span> connection.prepareCall(<span class="string">&quot;call pro_getEname(?,?)&quot;</span>);</span><br><span class="line">            <span class="comment">// 设置输入参数的值   </span></span><br><span class="line">            prepareCall.setObject(<span class="number">1</span>,empno);</span><br><span class="line">            <span class="comment">// 注册输出参数的类型 </span></span><br><span class="line">            prepareCall.registerOutParameter(<span class="number">2</span>,OracleTypes.VARCHAR);</span><br><span class="line">            <span class="keyword">return</span> prepareCall;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="keyword">new</span> <span class="title class_">CallableStatementCallback</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">doInCallableStatement</span><span class="params">(</span></span><br><span class="line"><span class="params">                CallableStatement callablestatement)</span> <span class="keyword">throws</span> SQLException,</span><br><span class="line">                DataAccessException &#123;</span><br><span class="line">            <span class="comment">//真正的执行</span></span><br><span class="line">            callablestatement.execute();</span><br><span class="line">            <span class="comment">// 获取输出参数的值  </span></span><br><span class="line">            <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> callablestatement.getString(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> ename;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> execute;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">//批量添加</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(List&lt;Emp&gt; emps)</span> &#123;</span><br><span class="line">    List&lt;Object[]&gt; os=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Object[]&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Emp emp: emps) &#123;</span><br><span class="line">        os.add(<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;emp.getEmpno(),emp.getEname(),emp.getJob(),      emp.getMgr(),emp.getHiredate(),emp.getSal(),emp.getComm(),emp.getDeptno()&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] i = template.batchUpdate(<span class="string">&quot;insert into emp values (?,?,?,?,?,?,?,?)&quot;</span>,os);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7-测试"><a href="#7-测试" class="headerlink" title="7 测试"></a>7 测试</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> bean.getEmpCount();</span><br><span class="line">System.out.println(count);</span><br><span class="line">----------------------------------------------------</span><br><span class="line"><span class="type">String</span> <span class="variable">dnameByename</span> <span class="operator">=</span> bean.getDnameByename(<span class="string">&quot;yan&quot;</span>);</span><br><span class="line">System.out.println(dnameByename);</span><br><span class="line">----------------------------------------------------</span><br><span class="line"><span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> bean.getEname(<span class="number">1000</span>);</span><br><span class="line">System.out.println(ename);</span><br><span class="line">----------------------------------------------------</span><br><span class="line"><span class="comment">//批量添加</span></span><br><span class="line">List&lt;Emp&gt; emps=Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="number">3</span>,<span class="string">&quot;yan&quot;</span>,<span class="string">&quot;teacher&quot;</span>,<span class="number">7788</span>,<span class="keyword">new</span> <span class="title class_">Date</span>(),<span class="number">1000.0</span>,<span class="number">5.0</span>,<span class="number">40</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="number">1</span>,<span class="string">&quot;kun&quot;</span>,<span class="string">&quot;teacher&quot;</span>,<span class="number">7788</span>,<span class="keyword">new</span> <span class="title class_">Date</span>(),<span class="number">1000.0</span>,<span class="number">5.0</span>,<span class="number">40</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="number">2</span>,<span class="string">&quot;hua&quot;</span>,<span class="string">&quot;teacher&quot;</span>,<span class="number">7788</span>,<span class="keyword">new</span> <span class="title class_">Date</span>(),<span class="number">1000.0</span>,<span class="number">5.0</span>,<span class="number">40</span>)</span><br><span class="line">    );</span><br><span class="line">bean.add(emps);</span><br></pre></td></tr></table></figure>

<h5 id="8-总结"><a href="#8-总结" class="headerlink" title="==8 总结=="></a>==8 总结==</h5><p>==jdbcTemplate 的方法==</p>
<ol>
<li><strong>execute() 回调</strong></li>
<li><strong>update() 增删改</strong></li>
<li><strong>queryForObject() 查一个</strong></li>
<li><strong>query() 查多个</strong></li>
<li><strong>batchUpdate() 批量操作</strong> </li>
</ol>

      </section>
      <section class="extra">
        
        
        
        
  <nav class="nav">
    <a></a>
    <a href="/2022/03/05/Pearbook/">Pearbook<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">文章目录：</h3>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Spring"><span class="toc-text">1  Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1.1 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BC%98%E7%BC%BA%E4%B8%8E%E6%A0%B8%E5%BF%83"><span class="toc-text">1.2 优缺与核心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%BB%84%E6%88%90"><span class="toc-text">1.3 组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E6%8B%93%E5%B1%95"><span class="toc-text">1.4 拓展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-jar%E5%8C%85"><span class="toc-text">1.5 jar包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-IOC"><span class="toc-text">2  IOC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-0-IOC%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">2.0 IOC的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-IOC%E7%9A%84%E6%8E%A8%E7%90%86"><span class="toc-text">2.1 IOC的推理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-IOC%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-text">2.2 IOC的本质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-IOC%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">2.3 IOC的原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-IOC%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">2.4  IOC创建对象的方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Spring%E5%AE%B9%E5%99%A8"><span class="toc-text">3 Spring容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%AB%E5%90%8D"><span class="toc-text">3.1 别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Bean%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">3.2  Bean的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-spring%E7%9A%84%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">3.3 spring的获取对象的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-import"><span class="toc-text">3.4  import</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-text">4 属性注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-0-%E5%B1%9E%E6%80%A7"><span class="toc-text">4.0 属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5"><span class="toc-text">4.1  构造器注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-set%E6%96%B9%E5%BC%8F%E6%B3%A8%E5%85%A5%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-text">4.2  set方式注入【重点】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-p%E5%90%8D%E7%A7%B0%E7%A9%BA%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-text">4.3  p名称空间注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-text">4.4  bean的作用域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Bean%E7%9A%84%E8%A3%85%E9%85%8D"><span class="toc-text">5 Bean的装配</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%9C%A8xml%E4%B8%AD%E6%98%BE%E7%A4%BA%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">5.1  在xml中显示的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-ByName-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-text">5.2 ByName 自动装配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-ByType-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-text">5.3  ByType 自动装配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-text">5.4  使用注解实现自动装配</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-text">6  注解开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-bean"><span class="toc-text">6.1 bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%B1%9E%E6%80%A7%E5%A6%82%E4%BD%95%E6%B3%A8%E5%85%A5"><span class="toc-text">6.2  属性如何注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-component%E7%9A%84%E6%B3%A8%E8%A7%A3"><span class="toc-text">6.3 @component的注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E5%B1%82%E6%B3%A8%E8%A7%A3"><span class="toc-text">6.4 层注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-AOP-%E6%B3%A8%E8%A7%A3"><span class="toc-text">6.5 AOP 注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D-5-4"><span class="toc-text">6.6  自动装配   (5.4)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-text">6.7  作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-%E5%B0%8F%E7%BB%93"><span class="toc-text">6.8  小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E4%BD%BF%E7%94%A8Java%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9B%BF%E6%8D%A2Spring%E7%9A%84XML%E9%85%8D%E7%BD%AE"><span class="toc-text">7 使用Java的方式替换Spring的XML配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%9A%E8%BF%87%E7%A8%8B"><span class="toc-text">第一种：过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%9A%E8%BF%87%E7%A8%8B"><span class="toc-text">第二种：过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93%EF%BC%9A-1"><span class="toc-text">小结：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-text">8 代理模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-text">8.1  静态代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%8A%A0%E6%B7%B1%E7%90%86%E8%A7%A3"><span class="toc-text">8.2 加深理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-text">8.3  动态代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-AOP"><span class="toc-text">9 AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E4%BB%80%E4%B9%88%E6%98%AFAOP"><span class="toc-text">9.1  什么是AOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-AOP%E5%9C%A8Spring%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">9.2 AOP在Spring中的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E4%BD%BF%E7%94%A8Spring%E5%AE%9E%E7%8E%B0AOP"><span class="toc-text">9.3 使用Spring实现AOP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Spring%EF%BC%9A%E6%95%B4%E5%90%88MyBatis"><span class="toc-text">10 Spring：整合MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E5%9B%9E%E5%BF%86MyBatis"><span class="toc-text">10.1 回忆MyBatis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-MyBatis-Spring%E5%AD%A6%E4%B9%A0"><span class="toc-text">10.2 MyBatis-Spring学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E6%95%B4%E5%90%88%E5%AE%9E%E7%8E%B0%E4%B8%80"><span class="toc-text">10.3 整合实现一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E6%95%B4%E5%90%88%E5%AE%9E%E7%8E%B0%E4%BA%8C"><span class="toc-text">10.4 整合实现二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1"><span class="toc-text">11 声明式事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E5%9B%9E%E9%A1%BE%E4%BA%8B%E5%8A%A1"><span class="toc-text">11.1 回顾事务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E6%B5%8B%E8%AF%95"><span class="toc-text">11.2 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-Spring%E4%B8%AD%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">11.3 Spring中的事务管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-4-%E6%80%9D%E8%80%83%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-text">11.4 思考问题？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-JdbcTemplate"><span class="toc-text">12 JdbcTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-JdbcTemplate-%E4%BB%8B%E7%BB%8D"><span class="toc-text">1 JdbcTemplate 介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JdbcTemplate-%E4%BD%BF%E7%94%A8"><span class="toc-text">2 JdbcTemplate 使用</span></a></li></ol></li></ol>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"><a 
        href="tencent://message/?Menu=yes&uin=2446632101 "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#12B7F5'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconQQ "></i>
      </a><a 
        href="https://github.com/richiele "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#9f7be1'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  icongithub-fill "></i>
      </a><a 
        href="mailto:richiele1314@163.com "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color=#FF3B00" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconmail"></i>
      </a></div>
  
    <div class="footer-copyright"><p>黎书·No One But You</p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
  
    
<script src="/js/color-mode.js"></script>

  
  
</body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>








<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>













</html>